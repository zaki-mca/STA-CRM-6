(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3571],{20485:(e,t,s)=>{"use strict";s.d(t,{K:()=>i});var a=s(95155);s(12115);var r=s(16559),n=s(97168);function i(e){let{title:t,description:s,open:i,onOpenChange:l,onConfirm:d,confirmText:o="Confirm",cancelText:c="Cancel",variant:x="destructive"}=e;return(0,a.jsx)(r.Lt,{open:i,onOpenChange:l,children:(0,a.jsxs)(r.EO,{children:[(0,a.jsxs)(r.wd,{children:[(0,a.jsx)(r.r7,{children:t}),(0,a.jsx)(r.$v,{children:s})]}),(0,a.jsxs)(r.ck,{children:[(0,a.jsx)(r.Zr,{children:c}),(0,a.jsx)(r.Rx,{asChild:!0,children:(0,a.jsx)(n.$,{variant:x,onClick:d,children:o})})]})]})})}},52396:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>X});var a=s(95155),r=s(12115),n=s(97168),i=s(89852),l=s(88145),d=s(88524),o=s(88482),c=s(49251),x=s(58642),m=s(9403),u=s(99840),h=s(79159),p=s(96371),f=s(37108),g=s(69074),j=s(55868),y=s(33109),b=s(1243);let w=u.L3;function v(e){var t,s;let{product:r,open:n,onOpenChange:i}=e,{data:c}=(0,h.m)(),{orders:x}=(0,p.h)();if(!r)return null;let m="number"==typeof r.buyPrice?r.buyPrice:Number(r.buyPrice)||0,v="number"==typeof r.sellPrice?r.sellPrice:Number(r.sellPrice)||0,N=x.filter(e=>e.items.some(e=>e.product.id===r.id)),C=N.reduce((e,t)=>{let s=t.items.find(e=>e.product.id===r.id);return e+((null==s?void 0:s.quantity)||0)},0),S=N.reduce((e,t)=>{let s=t.items.find(e=>e.product.id===r.id);return e+((null==s?void 0:s.total)||0)},0),k=m>0?((v-m)/m*100).toFixed(1):"0.0",P=10>(r.quantity||0),_=[{id:1,date:new Date("2024-01-15"),type:"In",quantity:50,reason:"Initial stock"},{id:2,date:new Date("2024-02-01"),type:"Out",quantity:20,reason:"Sale to ABC Corp"},{id:3,date:new Date("2024-02-15"),type:"In",quantity:30,reason:"Restock from supplier"},{id:4,date:new Date("2024-03-01"),type:"Out",quantity:15,reason:"Sale to XYZ Ltd"}];return(0,a.jsx)(u.lG,{open:n,onOpenChange:i,children:(0,a.jsxs)(u.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(u.c7,{children:(0,a.jsxs)(w,{className:"flex items-center space-x-2",children:[(0,a.jsx)(f.A,{className:"h-5 w-5"}),(0,a.jsxs)("span",{children:["Product Details: ",r.name]})]})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Product Information"})}),(0,a.jsxs)(o.Wu,{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Product Name"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:r.name})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Reference"}),(0,a.jsx)("p",{className:"font-mono",children:r.reference})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Category"}),(0,a.jsx)(l.E,{variant:"secondary",children:(null===(t=r.category)||void 0===t?void 0:t.name)||"Uncategorized"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Brand"}),(0,a.jsx)(l.E,{variant:"outline",children:(null===(s=r.brand)||void 0===s?void 0:s.name)||"Unbranded"})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Description"}),(0,a.jsx)("p",{children:r.description})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Created"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)("span",{children:r.createdAt&&"function"==typeof r.createdAt.toLocaleDateString?r.createdAt.toLocaleDateString():"N/A"})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4",children:[(0,a.jsx)(o.Zp,{children:(0,a.jsx)(o.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.A,{className:"h-8 w-8 text-blue-600"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-2xl font-bold",children:["number"==typeof m?m.toFixed(2):"0.00"," DZD"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Buy Price"})]})]})})}),(0,a.jsx)(o.Zp,{children:(0,a.jsx)(o.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.A,{className:"h-8 w-8 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-2xl font-bold",children:["number"==typeof v?v.toFixed(2):"0.00"," DZD"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Sell Price"})]})]})})}),(0,a.jsx)(o.Zp,{children:(0,a.jsx)(o.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(y.A,{className:"h-8 w-8 text-purple-600"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-2xl font-bold ".concat(Number.parseFloat(k)>20?"text-green-600":"text-orange-600"),children:[k,"%"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Profit Margin"})]})]})})}),(0,a.jsx)(o.Zp,{children:(0,a.jsx)(o.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(f.A,{className:"h-8 w-8 text-orange-600"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("p",{className:"text-2xl font-bold ".concat(P?"text-red-600":"text-gray-900"),children:r.quantity}),P&&(0,a.jsx)(b.A,{className:"h-5 w-5 text-red-500"})]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Current Stock"})]})]})})})]}),(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsx)(o.Zp,{children:(0,a.jsx)(o.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(y.A,{className:"h-8 w-8 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:C}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Total Units Sold"})]})]})})}),(0,a.jsx)(o.Zp,{children:(0,a.jsx)(o.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.A,{className:"h-8 w-8 text-green-600"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[S.toLocaleString()," DZD"]}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Total Revenue"})]})]})})})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Stock Movement History"})}),(0,a.jsx)(o.Wu,{children:(0,a.jsxs)(d.XI,{children:[(0,a.jsx)(d.A0,{children:(0,a.jsxs)(d.Hj,{children:[(0,a.jsx)(d.nd,{children:"Date"}),(0,a.jsx)(d.nd,{children:"Type"}),(0,a.jsx)(d.nd,{children:"Quantity"}),(0,a.jsx)(d.nd,{children:"Reason"})]})}),(0,a.jsx)(d.BF,{children:_.map(e=>(0,a.jsxs)(d.Hj,{children:[(0,a.jsx)(d.nA,{children:e.date&&"function"==typeof e.date.toLocaleDateString?e.date.toLocaleDateString():"N/A"}),(0,a.jsx)(d.nA,{children:(0,a.jsx)(l.E,{variant:"In"===e.type?"default":"secondary",children:e.type})}),(0,a.jsxs)(d.nA,{className:"In"===e.type?"text-green-600":"text-red-600",children:["In"===e.type?"+":"-",e.quantity]}),(0,a.jsx)(d.nA,{children:e.reason})]},e.id))})]})})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsx)(o.aR,{children:(0,a.jsx)(o.ZB,{children:"Related Orders"})}),(0,a.jsx)(o.Wu,{children:N.length>0?(0,a.jsxs)(d.XI,{children:[(0,a.jsx)(d.A0,{children:(0,a.jsxs)(d.Hj,{children:[(0,a.jsx)(d.nd,{children:"Order Number"}),(0,a.jsx)(d.nd,{children:"Client"}),(0,a.jsx)(d.nd,{children:"Date"}),(0,a.jsx)(d.nd,{children:"Quantity"}),(0,a.jsx)(d.nd,{children:"Amount"}),(0,a.jsx)(d.nd,{children:"Status"})]})}),(0,a.jsx)(d.BF,{children:N.map(e=>{var t;let s=e.items.find(e=>e.product.id===r.id);return(0,a.jsxs)(d.Hj,{children:[(0,a.jsx)(d.nA,{className:"font-medium",children:e.orderNumber||e.id}),(0,a.jsx)(d.nA,{children:(null===(t=e.client)||void 0===t?void 0:t.name)||"Unknown Client"}),(0,a.jsx)(d.nA,{children:e.orderDate&&"function"==typeof e.orderDate.toLocaleDateString?e.orderDate.toLocaleDateString():"N/A"}),(0,a.jsx)(d.nA,{children:(null==s?void 0:s.quantity)||0}),(0,a.jsxs)(d.nA,{children:[((null==s?void 0:s.total)||0).toLocaleString()," DZD"]}),(0,a.jsx)(d.nA,{children:(0,a.jsx)(l.E,{variant:"outline",children:e.status?e.status.charAt(0).toUpperCase()+e.status.slice(1):"Unknown"})})]},e.id)})})]}):(0,a.jsxs)("div",{className:"text-center py-8 text-gray-500",children:[(0,a.jsx)(f.A,{className:"h-12 w-12 mx-auto mb-4 text-gray-300"}),(0,a.jsx)("p",{children:"No orders found for this product"})]})})]})]})]})})}var N=s(20485),C=s(5749),S=s(81304),k=s(84616),P=s(47924),_=s(92657),A=s(13717),D=s(62525),z=s(76981),L=s(5196),R=s(53999);let B=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(z.bL,{ref:t,className:(0,R.cn)("peer h-4 w-4 shrink-0 rounded-sm border border-primary ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=checked]:text-primary-foreground",s),...r,children:(0,a.jsx)(z.C1,{className:(0,R.cn)("flex items-center justify-center text-current"),children:(0,a.jsx)(L.A,{className:"h-4 w-4"})})})});B.displayName=z.bL.displayName;var F=s(82714),O=s(60704);let Z=O.bL,q=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(O.B8,{ref:t,className:(0,R.cn)("inline-flex h-10 items-center justify-center rounded-md bg-muted p-1 text-muted-foreground",s),...r})});q.displayName=O.B8.displayName;let E=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(O.l9,{ref:t,className:(0,R.cn)("inline-flex items-center justify-center whitespace-nowrap rounded-sm px-3 py-1.5 text-sm font-medium ring-offset-background transition-all focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 data-[state=active]:bg-background data-[state=active]:text-foreground data-[state=active]:shadow-sm",s),...r})});E.displayName=O.l9.displayName;let I=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(O.UC,{ref:t,className:(0,R.cn)("mt-2 ring-offset-background focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2",s),...r})});I.displayName=O.UC.displayName;var U=s(95784),T=s(4884);let W=r.forwardRef((e,t)=>{let{className:s,...r}=e,n=T.bL,i=T.zi;return(0,a.jsx)(n,{className:(0,R.cn)("peer inline-flex h-6 w-11 shrink-0 cursor-pointer items-center rounded-full border-2 border-transparent transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 focus-visible:ring-offset-background disabled:cursor-not-allowed disabled:opacity-50 data-[state=checked]:bg-primary data-[state=unchecked]:bg-input",s),...r,ref:t,children:(0,a.jsx)(i,{className:(0,R.cn)("pointer-events-none block h-5 w-5 rounded-full bg-background shadow-lg ring-0 transition-transform data-[state=checked]:translate-x-5 data-[state=unchecked]:translate-x-0")})})});W.displayName=T.bL.displayName;var J=s(54073);let $=r.forwardRef((e,t)=>{let{className:s,...r}=e,n=J.bL,i=J.CC,l=J.Q6,d=J.zi;return(0,a.jsxs)(n,{ref:t,className:(0,R.cn)("relative flex w-full touch-none select-none items-center",s),...r,children:[(0,a.jsx)(i,{className:"relative h-2 w-full grow overflow-hidden rounded-full bg-secondary",children:(0,a.jsx)(l,{className:"absolute h-full bg-primary"})}),(0,a.jsx)(d,{className:"block h-5 w-5 rounded-full border-2 border-primary bg-background ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50"})]})});$.displayName=J.bL.displayName;var H=s(26597),G=s(91788),K=s(66766),V=s(51362);function M(e){let{products:t,open:s,onOpenChange:i}=e,[l,d]=(0,r.useState)({showName:!0,showPrice:!0,showReference:!0,showBarcode:!0,showCategory:!1,showBrand:!1,showLogo:!0,columns:3,fontSize:10,padding:5,template:"standard",pageSize:"a4"}),{theme:o}=(0,V.D)(),[c,x]=(0,r.useState)("preview"),m=(0,r.useRef)(null),h=(e,t,s)=>{let a=e.replace(/\D/g,"").substring(0,13);for(;a.length<13;)a="0"+a;let r=document.createElement("canvas");r.width=t,r.height=s;let n=r.getContext("2d");if(n){n.fillStyle="white",n.fillRect(0,0,t,s);let e=10;n.fillStyle="black",n.fillRect(e,0,2,s-15),e+=4,n.fillRect(e,0,2,s-15),e+=4;for(let t=0;t<12;t++){let r=parseInt(a[t]);for(let t=0;t<4;t++)(r+t)%2==0&&n.fillRect(e,0,2,s-15),e+=2;5===t&&(e+=2,n.fillRect(e,0,2,s-15),e+=4,n.fillRect(e,0,2,s-15),e+=4)}n.fillRect(e,0,2,s-15),e+=4,n.fillRect(e,0,2,s-15),n.font="10px Arial",n.fillText(a,t/2-30,s-5)}return r.toDataURL("image/png")},p=e=>{"standard"===e?d(t=>({...t,showName:!0,showPrice:!0,showReference:!0,showBarcode:!0,showLogo:!0,showCategory:!1,showBrand:!1,columns:3,fontSize:10,padding:5,template:e})):"compact"===e?d(t=>({...t,showName:!0,showPrice:!0,showReference:!1,showBarcode:!0,showLogo:!1,showCategory:!1,showBrand:!1,columns:4,fontSize:8,padding:3,template:e})):"detailed"===e&&d(t=>({...t,showName:!0,showPrice:!0,showReference:!0,showBarcode:!0,showLogo:!0,showCategory:!0,showBrand:!0,columns:2,fontSize:12,padding:8,template:e}))};(0,r.useEffect)(()=>{p(l.template)},[l.template]);let f=(e,t)=>{d(s=>({...s,[e]:t}))};return(0,a.jsx)(u.lG,{open:s,onOpenChange:i,children:(0,a.jsxs)(u.Cf,{className:"max-w-4xl max-h-[80vh] overflow-y-auto",children:[(0,a.jsx)(u.c7,{children:(0,a.jsx)(u.L3,{children:"Print Product Labels"})}),(0,a.jsxs)(Z,{defaultValue:"preview",className:"w-full",value:c,onValueChange:x,children:[(0,a.jsxs)(q,{className:"grid w-full grid-cols-3",children:[(0,a.jsx)(E,{value:"preview",children:"Preview"}),(0,a.jsx)(E,{value:"settings",children:"Label Settings"}),(0,a.jsx)(E,{value:"templates",children:"Templates"})]}),(0,a.jsxs)(I,{value:"preview",className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("div",{children:(0,a.jsxs)("p",{className:"text-sm text-gray-500",children:["Previewing ",t.length," product labels"]})}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsxs)(n.$,{variant:"outline",onClick:()=>{let e=new H.uE({orientation:"portrait",unit:"mm",format:l.pageSize}),s="a4"===l.pageSize?210:216,a="a4"===l.pageSize?297:279,r=(s-20)/l.columns,n=10,i=10,d=30+15*!!l.showBarcode+(l.showCategory||l.showBrand?5:0),o=0;if(l.showLogo)try{o=10,e.addImage("/STA-LOGO.webp","WEBP",0,0,10,10)}catch(e){console.error("Error adding logo to PDF:",e)}t.forEach((t,c)=>{var x,m;e.rect(n,i,r-2,d-2,"S");let u=i+5;if(l.showLogo)try{let t=.6*r;e.addImage("/STA-LOGO.webp","WEBP",n+(r-2-t)/2,u,t,o),u+=o+2}catch(e){console.error("Error adding logo to PDF:",e)}l.showName&&(e.setFontSize(l.fontSize+2),e.text(t.name,n+r/2,u,{align:"center"}),u+=7),l.showReference&&(e.setFontSize(l.fontSize),e.text("Ref: ".concat(t.reference||"N/A"),n+3,u),u+=5),l.showPrice&&(e.setFontSize(l.fontSize+2),e.setFont(void 0,"bold"),e.text("".concat(t.sellPrice.toFixed(2)," DZD"),n+3,u),e.setFont(void 0,"normal"),u+=5),l.showCategory&&(e.setFontSize(l.fontSize-2),e.text("Cat: ".concat((null===(x=t.category)||void 0===x?void 0:x.name)||"Uncategorized"),n+3,u),u+=4),l.showBrand&&(e.setFontSize(l.fontSize-2),e.text("Brand: ".concat((null===(m=t.brand)||void 0===m?void 0:m.name)||"Unbranded"),n+3,u),u+=4),l.showBarcode&&(e.setFontSize(8),e.text("*".concat(t.id.substring(0,10),"*"),n+r/2,u,{align:"center"})),(n+=r)+r>s-10&&(n=10,(i+=d)+d>a-10&&(e.addPage(),i=10))}),e.save("product-labels.pdf"),C.oR.success("Labels exported successfully",{position:"top-right",autoClose:3e3})},children:[(0,a.jsx)(G.A,{className:"mr-2 h-4 w-4"}),"Export PDF"]}),(0,a.jsxs)(n.$,{onClick:()=>{if(!m.current)return;let e=m.current,t="\n      @page { size: ".concat(l.pageSize,"; margin: 10mm; }\n      body { font-family: Arial, sans-serif; background-color: white; color: black; }\n      .label-grid { \n        display: grid;\n        grid-template-columns: repeat(").concat(l.columns,", 1fr);\n        gap: 8px;\n        padding: 0;\n      }\n      .label-item {\n        border: 1px solid #ccc;\n        padding: ").concat(l.padding,"px;\n        border-radius: 4px;\n        display: flex;\n        flex-direction: column;\n        align-items: center;\n      }\n      .label-logo {\n        margin-bottom: 5px;\n        text-align: center;\n      }\n      .label-name {\n        font-weight: bold;\n        font-size: ").concat(l.fontSize+2,"px;\n        margin-bottom: 3px;\n        text-align: center;\n      }\n      .label-ref {\n        font-size: ").concat(l.fontSize,"px;\n        margin-bottom: 2px;\n      }\n      .label-price {\n        font-size: ").concat(l.fontSize,"px;\n        font-weight: 500;\n        margin-bottom: 2px;\n      }\n      .label-category, .label-brand {\n        font-size: ").concat(l.fontSize-2,"px;\n        margin-bottom: 1px;\n      }\n      .label-barcode {\n        margin-top: 5px;\n        text-align: center;\n      }\n    "),s=window.open("","_blank");if(!s){alert("Please allow pop-ups to print labels");return}s.document.write("\n      <html>\n        <head>\n          <title>Product Labels</title>\n          <style>".concat(t,'</style>\n        </head>\n        <body>\n          <div class="label-grid">\n            ').concat(Array.from(e.querySelectorAll(".label-item")).map(e=>e.outerHTML).join(""),"\n          </div>\n        </body>\n      </html>\n    ")),s.document.close(),s.focus(),s.print(),s.close()},children:[(0,a.jsx)(S.A,{className:"mr-2 h-4 w-4"}),"Print"]})]})]}),(0,a.jsx)("div",{className:"border rounded-lg p-4 bg-white dark:bg-gray-800",children:(0,a.jsx)("div",{ref:m,children:(0,a.jsx)("div",{className:"grid gap-2 label-grid",style:{gridTemplateColumns:"repeat(".concat(l.columns,", 1fr)")},children:t.map(e=>(0,a.jsxs)("div",{className:"border rounded p-2 flex flex-col label-item",style:{padding:"".concat(l.padding,"px")},children:[l.showLogo&&(0,a.jsx)("div",{className:"flex justify-center mb-2 label-logo",children:(0,a.jsx)(K.default,{src:"/STA-LOGO.webp",alt:"STA Logo",width:80,height:30,className:"h-auto"})}),l.showName&&(0,a.jsx)("h3",{className:"font-bold text-center label-name text-black dark:text-white",style:{fontSize:"".concat(l.fontSize+2,"px")},children:e.name}),l.showReference&&(0,a.jsxs)("p",{className:"text-sm label-ref text-black dark:text-white",style:{fontSize:"".concat(l.fontSize,"px")},children:["Ref: ",e.reference||"N/A"]}),l.showPrice&&(0,a.jsxs)("p",{className:"font-medium label-price text-black dark:text-white",style:{fontSize:"".concat(l.fontSize,"px")},children:["Price: ",e.sellPrice.toFixed(2)," DZD"]}),l.showCategory&&e.category&&(0,a.jsxs)("p",{className:"text-xs label-category text-gray-600 dark:text-gray-300",style:{fontSize:"".concat(l.fontSize-2,"px")},children:["Category: ",e.category.name||"Uncategorized"]}),l.showBrand&&e.brand&&(0,a.jsxs)("p",{className:"text-xs label-brand text-gray-600 dark:text-gray-300",style:{fontSize:"".concat(l.fontSize-2,"px")},children:["Brand: ",e.brand.name||"Unbranded"]}),l.showBarcode&&(0,a.jsx)("div",{className:"mt-2 label-barcode",children:(0,a.jsx)("img",{src:h(e.id||"0000000000000",100,40),alt:"EAN Barcode",className:"w-full max-w-[120px] mx-auto h-auto"})})]},e.id))})})})]}),(0,a.jsx)(I,{value:"settings",className:"space-y-4",children:(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Content Options"}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(F.J,{htmlFor:"showLogo",children:"Show Logo"}),(0,a.jsx)(W,{id:"showLogo",checked:l.showLogo,onCheckedChange:e=>f("showLogo",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(F.J,{htmlFor:"showName",children:"Show Product Name"}),(0,a.jsx)(W,{id:"showName",checked:l.showName,onCheckedChange:e=>f("showName",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(F.J,{htmlFor:"showPrice",children:"Show Price"}),(0,a.jsx)(W,{id:"showPrice",checked:l.showPrice,onCheckedChange:e=>f("showPrice",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(F.J,{htmlFor:"showReference",children:"Show Reference"}),(0,a.jsx)(W,{id:"showReference",checked:l.showReference,onCheckedChange:e=>f("showReference",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(F.J,{htmlFor:"showBarcode",children:"Show Barcode"}),(0,a.jsx)(W,{id:"showBarcode",checked:l.showBarcode,onCheckedChange:e=>f("showBarcode",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(F.J,{htmlFor:"showCategory",children:"Show Category"}),(0,a.jsx)(W,{id:"showCategory",checked:l.showCategory,onCheckedChange:e=>f("showCategory",e)})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between",children:[(0,a.jsx)(F.J,{htmlFor:"showBrand",children:"Show Brand"}),(0,a.jsx)(W,{id:"showBrand",checked:l.showBrand,onCheckedChange:e=>f("showBrand",e)})]})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Layout Options"}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(F.J,{children:"Columns per row"}),(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)(U.l6,{value:l.columns.toString(),onValueChange:e=>f("columns",parseInt(e)),children:[(0,a.jsx)(U.bq,{children:(0,a.jsx)(U.yv,{placeholder:"Columns"})}),(0,a.jsx)(U.gC,{children:[1,2,3,4,5,6].map(e=>(0,a.jsx)(U.eb,{value:e.toString(),children:e},e))})]})})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(F.J,{children:["Font Size: ",l.fontSize,"px"]}),(0,a.jsx)($,{min:6,max:16,step:1,value:[l.fontSize],onValueChange:e=>f("fontSize",e[0])})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)(F.J,{children:["Padding: ",l.padding,"px"]}),(0,a.jsx)($,{min:0,max:20,step:1,value:[l.padding],onValueChange:e=>f("padding",e[0])})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(F.J,{children:"Page Size"}),(0,a.jsxs)(U.l6,{value:l.pageSize,onValueChange:e=>f("pageSize",e),children:[(0,a.jsx)(U.bq,{children:(0,a.jsx)(U.yv,{placeholder:"Page Size"})}),(0,a.jsxs)(U.gC,{children:[(0,a.jsx)(U.eb,{value:"a4",children:"A4"}),(0,a.jsx)(U.eb,{value:"letter",children:"Letter"})]})]})]})]})]})}),(0,a.jsxs)(I,{value:"templates",className:"space-y-4",children:[(0,a.jsx)("h3",{className:"font-medium",children:"Choose a Template"}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsxs)("div",{className:"border rounded-lg p-4 cursor-pointer ".concat("standard"===l.template?"border-primary bg-primary/5":""),onClick:()=>p("standard"),children:[(0,a.jsx)("h4",{className:"font-medium",children:"Standard"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Shows name, price, reference, logo and barcode. 3 columns per page."})]}),(0,a.jsxs)("div",{className:"border rounded-lg p-4 cursor-pointer ".concat("compact"===l.template?"border-primary bg-primary/5":""),onClick:()=>p("compact"),children:[(0,a.jsx)("h4",{className:"font-medium",children:"Compact"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Shows only name, price and barcode. Smaller size with 4 columns per page."})]}),(0,a.jsxs)("div",{className:"border rounded-lg p-4 cursor-pointer ".concat("detailed"===l.template?"border-primary bg-primary/5":""),onClick:()=>p("detailed"),children:[(0,a.jsx)("h4",{className:"font-medium",children:"Detailed"}),(0,a.jsx)("p",{className:"text-sm text-gray-500",children:"Shows all details including logo, barcode, brand, and category. 2 columns per page."})]})]})]})]})]})})}function X(){let{data:e,addProduct:t,updateProduct:s,deleteProduct:u,addCategory:p,addBrand:f}=(0,h.m)(),[g,j]=(0,r.useState)(""),[y,w]=(0,r.useState)(1),[z,L]=(0,r.useState)(10),[R,F]=(0,r.useState)(null),[O,Z]=(0,r.useState)(null),[q,E]=(0,r.useState)(!1),[I,U]=(0,r.useState)(!1),[T,W]=(0,r.useState)(null),[J,$]=(0,r.useState)([]),[H,G]=(0,r.useState)(!1),K=e=>{let t="asc";R&&R.key===e&&"asc"===R.direction&&(t="desc"),F({key:e,direction:t})},V=[...e.products.filter(e=>{var t,s;return""===g||e.name.toLowerCase().includes(g.toLowerCase())||e.reference.toLowerCase().includes(g.toLowerCase())||(null===(t=e.category)||void 0===t?void 0:t.name.toLowerCase().includes(g.toLowerCase()))||(null===(s=e.brand)||void 0===s?void 0:s.name.toLowerCase().includes(g.toLowerCase()))})].sort((e,t)=>{if(!R)return 0;let s=e[R.key],a=t[R.key];return s<a?"asc"===R.direction?-1:1:s>a?"asc"===R.direction?1:-1:0}),X=Math.ceil(V.length/z),Q=(y-1)*z,Y=V.slice(Q,Q+z),ee=e=>{Z(e),E(!0)},et=e=>{W(e),U(!0)},es=async()=>{if(T)try{await u(T),C.oR.success("Product deleted successfully",{position:"top-right",autoClose:3e3}),W(null)}catch(e){console.error("Error deleting product:",e),e.message&&e.message.includes("still referenced from table")?e.message.includes("invoice_items")?C.oR.error("Cannot delete this product because it appears in one or more invoices. Please remove it from invoices first.",{position:"top-right",autoClose:5e3}):e.message.includes("order_items")?C.oR.error("Cannot delete this product because it appears in one or more orders. Please remove it from orders first.",{position:"top-right",autoClose:5e3}):C.oR.error("Cannot delete this product because it is referenced by other records in the system.",{position:"top-right",autoClose:5e3}):C.oR.error("Failed to delete product: "+(e.message||"Unknown error"),{position:"top-right",autoClose:5e3})}},ea=e=>{$(t=>t.includes(e)?t.filter(t=>t!==e):[...t,e])};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Products"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage your inventory and stock levels"})]}),(0,a.jsxs)(o.Zp,{children:[(0,a.jsxs)(o.aR,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(o.ZB,{children:"All Products"}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsxs)(n.$,{variant:"outline",onClick:()=>{if(0===J.length){C.oR.error("Please select at least one product to print labels",{position:"top-right",autoClose:3e3});return}G(!0)},disabled:0===J.length,children:[(0,a.jsx)(S.A,{className:"mr-2 h-4 w-4"}),"Print Labels (",J.length,")"]}),(0,a.jsx)(m.i,{categories:e.categories,brands:e.brands,onSubmit:t,onAddCategory:p,onAddBrand:f,trigger:(0,a.jsxs)(n.$,{children:[(0,a.jsx)(k.A,{className:"mr-2 h-4 w-4"}),"Add Product"]})})]})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(P.A,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)(i.p,{placeholder:"Search products...",value:g,onChange:e=>j(e.target.value),className:"max-w-sm"})]})]}),(0,a.jsxs)(o.Wu,{children:[(0,a.jsxs)(d.XI,{children:[(0,a.jsx)(d.A0,{children:(0,a.jsxs)(d.Hj,{children:[(0,a.jsx)(d.nd,{className:"w-[50px]",children:(0,a.jsx)(B,{checked:Y.length>0&&J.length===Y.length,onCheckedChange:()=>{J.length===Y.length?$([]):$(Y.map(e=>e.id))}})}),(0,a.jsx)(x.a,{sortKey:"name",currentSort:R,onSort:K,children:"Name"}),(0,a.jsx)(x.a,{sortKey:"reference",currentSort:R,onSort:K,children:"Reference"}),(0,a.jsx)(d.nd,{children:"Description"}),(0,a.jsx)(d.nd,{children:"Category"}),(0,a.jsx)(d.nd,{children:"Brand"}),(0,a.jsx)(x.a,{sortKey:"buyPrice",currentSort:R,onSort:K,children:"Buy Price"}),(0,a.jsx)(x.a,{sortKey:"sellPrice",currentSort:R,onSort:K,children:"Sell Price"}),(0,a.jsx)(x.a,{sortKey:"quantity",currentSort:R,onSort:K,children:"Stock"}),(0,a.jsx)(d.nd,{children:"Margin"}),(0,a.jsx)(d.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(d.BF,{children:Y.map(t=>{var r,i;let o="number"==typeof t.buyPrice?t.buyPrice:Number(t.buyPrice)||0,c="number"==typeof t.sellPrice?t.sellPrice:Number(t.sellPrice)||0,x=o>0?((c-o)/o*100).toFixed(1):"0.0",u=10>(t.quantity||0);return(0,a.jsxs)(d.Hj,{children:[(0,a.jsx)(d.nA,{children:(0,a.jsx)(B,{checked:J.includes(t.id),onCheckedChange:()=>ea(t.id)})}),(0,a.jsx)(d.nA,{className:"font-medium",children:t.name}),(0,a.jsx)(d.nA,{children:t.reference}),(0,a.jsx)(d.nA,{className:"max-w-xs truncate",title:t.description,children:t.description}),(0,a.jsx)(d.nA,{children:(0,a.jsx)(l.E,{variant:"secondary",children:(null===(r=t.category)||void 0===r?void 0:r.name)||"Uncategorized"})}),(0,a.jsx)(d.nA,{children:(null===(i=t.brand)||void 0===i?void 0:i.name)||"Unbranded"}),(0,a.jsxs)(d.nA,{children:[o.toFixed(2)," DZD"]}),(0,a.jsxs)(d.nA,{children:[c.toFixed(2)," DZD"]}),(0,a.jsx)(d.nA,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:u?"text-red-600 font-medium":"",children:t.quantity||0}),u&&(0,a.jsx)(b.A,{className:"h-4 w-4 text-red-500"})]})}),(0,a.jsx)(d.nA,{children:(0,a.jsxs)("span",{className:Number.parseFloat(x)>20?"text-green-600":"text-orange-600",children:[x,"%"]})}),(0,a.jsx)(d.nA,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>ee(t),children:(0,a.jsx)(_.A,{className:"h-4 w-4"})}),(0,a.jsx)(m.i,{product:t,categories:e.categories,brands:e.brands,onSubmit:e=>s(t.id,e),onAddCategory:p,onAddBrand:f,trigger:(0,a.jsx)(n.$,{variant:"outline",size:"sm",children:(0,a.jsx)(A.A,{className:"h-4 w-4"})})}),(0,a.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>et(t.id),children:(0,a.jsx)(D.A,{className:"h-4 w-4"})})]})})]},t.id)})})]}),(0,a.jsx)(c.d,{currentPage:y,totalPages:X,pageSize:z,totalItems:V.length,onPageChange:w,onPageSizeChange:e=>{L(e),w(1)}})]})]}),(0,a.jsx)(v,{product:O,open:q,onOpenChange:E}),(0,a.jsx)(N.K,{title:"Delete Product",description:"Are you sure you want to delete this product? This action cannot be undone.",open:I,onOpenChange:U,onConfirm:es,confirmText:"Delete",cancelText:"Cancel"}),H&&(0,a.jsx)(M,{products:e.products.filter(e=>J.includes(e.id)),open:H,onOpenChange:G})]})}},68780:(e,t,s)=>{"use strict";s.d(t,{Z:()=>w});var a=s(95155),r=s(12115),n=s(97168),i=s(20547),l=s(53999);let d=i.bL,o=i.l9,c=r.forwardRef((e,t)=>{let{className:s,align:r="center",sideOffset:n=4,...d}=e;return(0,a.jsx)(i.ZL,{children:(0,a.jsx)(i.UC,{ref:t,align:r,sideOffset:n,className:(0,l.cn)("z-50 w-72 rounded-md border bg-popover p-4 text-popover-foreground shadow-md outline-none data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",s),...d})})});c.displayName=i.UC.displayName;var x=s(77740),m=s(47924);s(99840);let u=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(x.uB,{ref:t,className:(0,l.cn)("flex h-full w-full flex-col overflow-hidden rounded-md bg-popover text-popover-foreground",s),...r})});u.displayName=x.uB.displayName;let h=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsxs)("div",{className:"flex items-center border-b px-3","cmdk-input-wrapper":"",children:[(0,a.jsx)(m.A,{className:"mr-2 h-4 w-4 shrink-0 opacity-50"}),(0,a.jsx)(x.uB.Input,{ref:t,className:(0,l.cn)("flex h-11 w-full rounded-md bg-transparent py-3 text-sm outline-none placeholder:text-muted-foreground disabled:cursor-not-allowed disabled:opacity-50",s),...r})]})});h.displayName=x.uB.Input.displayName;let p=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(x.uB.List,{ref:t,className:(0,l.cn)("max-h-[300px] overflow-y-auto overflow-x-hidden",s),...r})});p.displayName=x.uB.List.displayName;let f=r.forwardRef((e,t)=>(0,a.jsx)(x.uB.Empty,{ref:t,className:"py-6 text-center text-sm",...e}));f.displayName=x.uB.Empty.displayName;let g=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(x.uB.Group,{ref:t,className:(0,l.cn)("overflow-hidden p-1 text-foreground [&_[cmdk-group-heading]]:px-2 [&_[cmdk-group-heading]]:py-1.5 [&_[cmdk-group-heading]]:text-xs [&_[cmdk-group-heading]]:font-medium [&_[cmdk-group-heading]]:text-muted-foreground",s),...r})});g.displayName=x.uB.Group.displayName,r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(x.uB.Separator,{ref:t,className:(0,l.cn)("-mx-1 h-px bg-border",s),...r})}).displayName=x.uB.Separator.displayName;let j=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)(x.uB.Item,{ref:t,className:(0,l.cn)("relative flex cursor-default gap-2 select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none data-[disabled=true]:pointer-events-none data-[selected='true']:bg-accent data-[selected=true]:text-accent-foreground data-[disabled=true]:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",s),...r})});j.displayName=x.uB.Item.displayName;var y=s(10081),b=s(5196);function w(e){let{value:t,onValueChange:s,options:i,placeholder:x,searchPlaceholder:m,className:w}=e,[v,N]=(0,r.useState)(!1),[C,S]=(0,r.useState)(""),k=i.find(e=>e.value===t),P=i.filter(e=>{let t=C.toLowerCase();return e.label.toLowerCase().includes(t)||e.category&&e.category.toLowerCase().includes(t)||e.brand&&e.brand.toLowerCase().includes(t)||e.description&&e.description.toLowerCase().includes(t)||e.email&&e.email.toLowerCase().includes(t)||e.domain&&e.domain.toLowerCase().includes(t)});return(0,a.jsxs)(d,{open:v,onOpenChange:N,children:[(0,a.jsx)(o,{asChild:!0,children:(0,a.jsxs)(n.$,{variant:"outline",role:"combobox","aria-expanded":v,className:(0,l.cn)("w-full justify-between",w),children:[k?k.label:x,(0,a.jsx)(y.A,{className:"ml-2 h-4 w-4 shrink-0 opacity-50"})]})}),(0,a.jsx)(c,{className:"w-full p-0",align:"start",children:(0,a.jsxs)(u,{shouldFilter:!1,children:[(0,a.jsx)(h,{placeholder:m,value:C,onValueChange:S}),(0,a.jsxs)(p,{children:[(0,a.jsx)(f,{children:"No item found."}),(0,a.jsx)(g,{className:"max-h-64 overflow-auto",children:P.map(e=>(0,a.jsxs)(j,{value:e.value,onSelect:e=>{s(e===t?"":e),N(!1),S("")},children:[(0,a.jsx)(b.A,{className:(0,l.cn)("mr-2 h-4 w-4",t===e.value?"opacity-100":"opacity-0")}),(0,a.jsxs)("div",{className:"flex-1",children:[(0,a.jsx)("div",{className:"font-medium",children:e.label}),(0,a.jsxs)("div",{className:"flex items-center gap-2 text-sm text-muted-foreground",children:[e.category&&(0,a.jsx)("span",{className:"bg-gray-100 px-2 py-0.5 rounded text-xs",children:e.category}),e.brand&&(0,a.jsx)("span",{className:"bg-blue-100 px-2 py-0.5 rounded text-xs",children:e.brand}),e.email&&(0,a.jsx)("span",{className:"text-blue-600",children:e.email}),e.domain&&(0,a.jsx)("span",{className:"bg-green-100 px-2 py-0.5 rounded text-xs",children:e.domain}),void 0!==e.price&&"number"==typeof e.price&&(0,a.jsxs)("span",{className:"font-medium text-green-600",children:["$",e.price.toFixed(2)]})]})]})]},e.value))})]})]})})]})}},96371:(e,t,s)=>{"use strict";s.d(t,{OrderProvider:()=>d,h:()=>o});var a=s(95155),r=s(12115),n=s(31886),i=s(5749);let l=(0,r.createContext)(void 0);function d(e){let{children:t}=e,[s,d]=(0,r.useState)([]),[o,c]=(0,r.useState)(!0),[x,m]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{c(!0),m(null);try{let e=((await n.N.getAll()).data||[]).map(e=>({id:e.id,orderNumber:e.order_number||"ORD-".concat(e.id.substring(0,8)),client:{id:e.client_id,name:e.client_name||"Unknown Client",email:e.client_email||"",address:e.client_address||"",phoneNumber:e.client_phone||""},items:(e.items||[]).map(e=>({id:e.id,product:{id:e.product_id,name:e.product_name||"Unknown Product",description:e.product_description||"",sellPrice:parseFloat(e.unit_price)||0},quantity:parseInt(e.quantity)||0,unitPrice:parseFloat(e.unit_price)||0,total:parseFloat(e.total)||0})),subtotal:parseFloat(e.total)||0,total:parseFloat(e.total)||0,status:e.status||"pending",orderDate:new Date(e.order_date),expectedDelivery:e.expected_delivery?new Date(e.expected_delivery):new Date,notes:e.notes||""}));d(e)}catch(e){console.error("Failed to fetch orders:",e),m(e.message||"Failed to fetch orders"),d([])}finally{c(!1)}})()},[]);let u=async e=>{try{let t=e.client_id?e:{client_id:e.client.id,order_date:e.order_date||new Date().toISOString().split("T")[0],expected_delivery:e.expectedDelivery,status:e.status||"pending",notes:e.notes,shipping_address:e.client.address,items:e.items.map(e=>({product_id:e.product.id,quantity:e.quantity,unit_price:e.unitPrice}))},s=await n.N.create(t),a={id:s.data.id,orderNumber:s.data.order_number||"ORD-".concat(s.data.id.substring(0,8)),client:{id:s.data.client_id,name:s.data.client_name||"Unknown Client",email:s.data.client_email||"",address:s.data.client_address||"",phoneNumber:s.data.client_phone||""},items:(s.data.items||[]).map(e=>({id:e.id,product:{id:e.product_id,name:e.product_name||"Unknown Product",description:e.product_description||"",sellPrice:parseFloat(e.unit_price)||0},quantity:parseInt(e.quantity)||0,unitPrice:parseFloat(e.unit_price)||0,total:parseFloat(e.total)||0})),subtotal:parseFloat(s.data.total)||0,total:parseFloat(s.data.total)||0,status:s.data.status||"pending",orderDate:new Date(s.data.order_date),expectedDelivery:s.data.expected_delivery?new Date(s.data.expected_delivery):new Date,notes:s.data.notes||""};return d(e=>[...e,a]),i.oR.success("Order #".concat(a.orderNumber," has been created successfully."),{position:"top-right",autoClose:3e3}),a}catch(e){throw console.error("Failed to add order:",e),e}},h=async(e,t)=>{try{let s=t.client_id?t:{client_id:t.client.id,order_date:t.order_date||new Date().toISOString().split("T")[0],expected_delivery:t.expectedDelivery,status:t.status||"pending",notes:t.notes,shipping_address:t.client.address,items:t.items.map(e=>({product_id:e.product.id,quantity:e.quantity,unit_price:e.unitPrice}))},a=await n.N.update(e,s),r={id:a.data.id,orderNumber:a.data.order_number||"ORD-".concat(a.data.id.substring(0,8)),client:{id:a.data.client_id,name:a.data.client_name||"Unknown Client",email:a.data.client_email||"",address:a.data.client_address||"",phoneNumber:a.data.client_phone||""},items:(a.data.items||[]).map(e=>({id:e.id,product:{id:e.product_id,name:e.product_name||"Unknown Product",description:e.product_description||"",sellPrice:parseFloat(e.unit_price)||0},quantity:parseInt(e.quantity)||0,unitPrice:parseFloat(e.unit_price)||0,total:parseFloat(e.total)||0})),subtotal:parseFloat(a.data.total)||0,total:parseFloat(a.data.total)||0,status:a.data.status||"pending",orderDate:new Date(a.data.order_date),expectedDelivery:a.data.expected_delivery?new Date(a.data.expected_delivery):new Date,notes:a.data.notes||""};return d(t=>t.map(t=>t.id===e?r:t)),r}catch(e){throw console.error("Failed to update order:",e),e}},p=async e=>{try{let t=s.find(t=>t.id===e);await n.N.delete(e),d(t=>t.filter(t=>t.id!==e)),i.oR.success("Order #".concat((null==t?void 0:t.orderNumber)||e," has been deleted successfully."),{position:"top-right",autoClose:3e3})}catch(e){throw console.error("Failed to delete order:",e),e}},f=async(e,t)=>{try{let a=await n.N.updateStatus(e,t),r=s.find(t=>t.id===e);if(!r)throw Error("Order with ID ".concat(e," not found"));let i={...r,status:a.data.status||"pending",orderDate:new Date(a.data.order_date),expectedDelivery:a.data.expected_delivery?new Date(a.data.expected_delivery):r.expectedDelivery};return d(t=>t.map(t=>t.id===e?i:t)),i}catch(e){throw console.error("Failed to update order status:",e),e}};return(0,a.jsx)(l.Provider,{value:{orders:s,loading:o,error:x,addOrder:u,updateOrder:h,deleteOrder:p,updateOrderStatus:f},children:t})}function o(){let e=(0,r.useContext)(l);if(void 0===e)throw Error("useOrders must be used within an OrderProvider");return e}},96699:(e,t,s)=>{Promise.resolve().then(s.bind(s,52396))},99474:(e,t,s)=>{"use strict";s.d(t,{T:()=>i});var a=s(95155),r=s(12115),n=s(53999);let i=r.forwardRef((e,t)=>{let{className:s,...r}=e;return(0,a.jsx)("textarea",{className:(0,n.cn)("flex min-h-[80px] w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm",s),ref:t,...r})});i.displayName="Textarea"}},e=>{var t=t=>e(e.s=t);e.O(0,[3930,4277,8543,4692,4810,203,3958,6928,697,4710,9403,8441,1684,7358],()=>t(96699)),_N_E=e.O()}]);