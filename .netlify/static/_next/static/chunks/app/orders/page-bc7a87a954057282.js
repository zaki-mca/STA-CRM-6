(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[1778],{14138:(e,t,s)=>{Promise.resolve().then(s.bind(s,58465))},29621:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("Code",[["polyline",{points:"16 18 22 12 16 6",key:"z7tu5w"}],["polyline",{points:"8 6 2 12 8 18",key:"1eg1df"}]])},58465:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>z});var a=s(95155),i=s(12115),r=s(97168),n=s(89852),l=s(88524),d=s(88482),c=s(99840),o=s(16559),x=s(95784),u=s(82714),h=s(99474),m=s(49251),p=s(58642),j=s(68780),v=s(18969),y=s(88145),N=s(37108),g=s(69074),f=s(57434),w=s(71007),D=s(28883),b=s(19420),_=s(4516);let A=e=>null==e||isNaN(e)?"0.00":e.toFixed(2),C=e=>{if(!e)return"N/A";try{let t=e instanceof Date?e:new Date(e);if(isNaN(t.getTime()))return"N/A";return t.toLocaleDateString()}catch(e){return console.error("Error formatting date:",e),"N/A"}};function S(e){var t,s,i,r;let{order:n,open:o,onOpenChange:x}=e;if(!n)return null;let u=c.L3;return(0,a.jsx)(c.lG,{open:o,onOpenChange:x,children:(0,a.jsxs)(c.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(c.c7,{children:(0,a.jsxs)(u,{className:"flex items-center space-x-2",children:[(0,a.jsx)(N.A,{className:"h-5 w-5"}),(0,a.jsxs)("span",{children:["Order Details: ",n.id]})]})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"Order Information"})}),(0,a.jsxs)(d.Wu,{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Order ID"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:n.id})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Status"}),(0,a.jsx)(y.E,{className:(e=>{switch(e){case"pending":return"bg-yellow-100 text-yellow-800";case"processing":return"bg-purple-100 text-purple-800";case"shipped":return"bg-indigo-100 text-indigo-800";case"delivered":return"bg-green-100 text-green-800";case"cancelled":return"bg-red-100 text-red-800";default:return"bg-gray-100 text-gray-800"}})(n.status),children:n.status.charAt(0).toUpperCase()+n.status.slice(1)})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Order Date"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)("span",{children:C(n.orderDate)})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Expected Delivery"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(g.A,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)("span",{children:C(n.expectedDelivery)})]})]}),n.notes&&(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Notes"}),(0,a.jsxs)("div",{className:"flex items-start space-x-1",children:[(0,a.jsx)(f.A,{className:"h-4 w-4 text-gray-400 mt-0.5"}),(0,a.jsx)("p",{className:"text-sm",children:n.notes})]})]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsxs)(d.ZB,{className:"flex items-center space-x-2",children:[(0,a.jsx)(w.A,{className:"h-5 w-5"}),(0,a.jsx)("span",{children:"Client Details"})]})}),(0,a.jsxs)(d.Wu,{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Name"}),(0,a.jsx)("p",{className:"text-lg font-semibold",children:(null===(t=n.client)||void 0===t?void 0:t.name)||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Email"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(D.A,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)("span",{children:(null===(s=n.client)||void 0===s?void 0:s.email)||"N/A"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Phone"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)("span",{children:(null===(i=n.client)||void 0===i?void 0:i.phoneNumber)||"N/A"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-gray-500",children:"Address"}),(0,a.jsxs)("div",{className:"flex items-start space-x-1",children:[(0,a.jsx)(_.A,{className:"h-4 w-4 text-gray-400 mt-0.5"}),(0,a.jsx)("span",{children:(null===(r=n.client)||void 0===r?void 0:r.address)||"N/A"})]})]})]})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"Order Items"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)(l.XI,{children:[(0,a.jsx)(l.A0,{children:(0,a.jsxs)(l.Hj,{children:[(0,a.jsx)(l.nd,{children:"Product"}),(0,a.jsx)(l.nd,{children:"Description"}),(0,a.jsx)(l.nd,{children:"Quantity"}),(0,a.jsx)(l.nd,{children:"Unit Price"}),(0,a.jsx)(l.nd,{children:"Total"})]})}),(0,a.jsx)(l.BF,{children:(n.items||[]).map((e,t)=>{var s,i;return(0,a.jsxs)(l.Hj,{children:[(0,a.jsx)(l.nA,{className:"font-medium",children:(null==e?void 0:null===(s=e.product)||void 0===s?void 0:s.name)||"N/A"}),(0,a.jsx)(l.nA,{className:"max-w-xs truncate",children:(null==e?void 0:null===(i=e.product)||void 0===i?void 0:i.description)||"N/A"}),(0,a.jsx)(l.nA,{children:(null==e?void 0:e.quantity)||0}),(0,a.jsxs)(l.nA,{children:[A((null==e?void 0:e.unitPrice)||(null==e?void 0:e.unit_price)||0)," DZD"]}),(0,a.jsxs)(l.nA,{className:"font-semibold",children:[A((null==e?void 0:e.total)||((null==e?void 0:e.quantity)||0)*((null==e?void 0:e.unitPrice)||(null==e?void 0:e.unit_price)||0))," DZD"]})]},(null==e?void 0:e.id)||t)})})]})})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsx)(d.aR,{children:(0,a.jsx)(d.ZB,{children:"Financial Summary"})}),(0,a.jsx)(d.Wu,{children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Subtotal:"}),(0,a.jsxs)("span",{children:[A(n.subtotal)," DZD"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Tax:"}),(0,a.jsxs)("span",{children:[A(n.tax)," DZD"]})]}),(0,a.jsxs)("div",{className:"flex justify-between font-bold text-lg border-t pt-2",children:[(0,a.jsx)("span",{children:"Total:"}),(0,a.jsxs)("span",{children:[A(n.total)," DZD"]})]})]})})]})]})]})})}var P=s(79159),O=s(96371),k=s(14186),I=s(40646);let F=(0,s(19946).A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);var q=s(62525),Z=s(84616),E=s(47924),T=s(92657),R=s(13717),U=s(5749);function z(){let{data:e,addClient:t,addProfessionalDomain:s}=(0,P.m)(),{orders:y,addOrder:g,updateOrder:f,deleteOrder:w,updateOrderStatus:D}=(0,O.h)(),[b,_]=(0,i.useState)(""),[A,C]=(0,i.useState)(1),[z,L]=(0,i.useState)(10),[$,B]=(0,i.useState)(null),[J,M]=(0,i.useState)(!1),[H,K]=(0,i.useState)(!1),[V,W]=(0,i.useState)(null),[G,X]=(0,i.useState)(null),[Q,Y]=(0,i.useState)(!1),[ee,et]=(0,i.useState)({clientId:"",items:[],expectedDelivery:"",notes:""}),es=e=>{let t="asc";$&&$.key===e&&"asc"===$.direction&&(t="desc"),B({key:e,direction:t})},ea=[...y.filter(e=>e.id.toLowerCase().includes(b.toLowerCase())||"".concat(e.client.name).toLowerCase().includes(b.toLowerCase()))].sort((e,t)=>{if(!$)return 0;let s=e[$.key],a=t[$.key];return void 0===s&&void 0===a?0:void 0===s?1:void 0===a?-1:s<a?"asc"===$.direction?-1:1:s>a?"asc"===$.direction?1:-1:0}),ei=Math.ceil(ea.length/z),er=(A-1)*z,en=ea.slice(er,er+z),el=e=>{X(e),Y(!0)},ed=e.products.map(e=>{var t,s;return{value:e.id,label:e.name,price:e.sellPrice,category:(null===(t=e.category)||void 0===t?void 0:t.name)||"Uncategorized",brand:(null===(s=e.brand)||void 0===s?void 0:s.name)||"Unbranded",description:e.description}}),ec=e.clients.map(e=>({value:e.id,label:"".concat(e.gender," ").concat(e.firstName," ").concat(e.lastName),email:e.email,domain:e.professionalDomain})),eo=()=>{et({...ee,items:[...ee.items,{productId:"",quantity:1,unitPrice:0}]})},ex=e=>{et({...ee,items:ee.items.filter((t,s)=>s!==e)})},eu=(t,s,a)=>{let i=[...ee.items];if(i[t]={...i[t],[s]:a},"productId"===s){let s=e.products.find(e=>e.id===a);s&&(i[t].unitPrice=s.sellPrice)}et({...ee,items:i})},eh=e=>{t(e);let s=Date.now().toString();et({...ee,clientId:s})},em=e=>{s({name:e})},ep=()=>{let t=e.clients.find(e=>e.id===ee.clientId);if(!t||0===ee.items.length)return;let s=ee.items.map((t,s)=>{let a=e.products.find(e=>e.id===t.productId);return{id:s.toString(),product:{id:a.id,name:a.name,description:a.description,sellPrice:a.sellPrice},quantity:t.quantity,unitPrice:t.unitPrice,total:t.quantity*t.unitPrice}}),a=s.reduce((e,t)=>e+t.total,0),i={client:{id:t.id,name:"".concat(t.firstName," ").concat(t.lastName),email:t.email,address:t.address,phoneNumber:t.phoneNumber},items:s,subtotal:a,total:a,status:"pending",order_date:new Date().toISOString().split("T")[0],expectedDelivery:new Date(ee.expectedDelivery),notes:ee.notes,orderNumber:"ORD-".concat(Date.now().toString().substring(0,8))};V?(f(V.id,i),U.oR.success("Order #".concat(V.orderNumber," has been updated successfully."),{position:"top-right",autoClose:3e3})):(g(i),U.oR.success("New order has been created successfully.",{position:"top-right",autoClose:3e3})),et({clientId:"",items:[],expectedDelivery:"",notes:""}),M(!1),K(!1),W(null)},ej=e=>{switch(e){case"pending":default:return(0,a.jsx)(k.A,{className:"h-4 w-4"});case"processing":case"shipped":return(0,a.jsx)(N.A,{className:"h-4 w-4"});case"delivered":return(0,a.jsx)(I.A,{className:"h-4 w-4"});case"cancelled":return(0,a.jsx)(F,{className:"h-4 w-4"})}},ev=t=>{let{isEdit:s=!1}=t;return(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{children:"Client"}),(0,a.jsxs)("div",{className:"flex space-x-2",children:[(0,a.jsx)(j.Z,{value:ee.clientId,onValueChange:e=>et({...ee,clientId:e}),options:ec,placeholder:"Select client",searchPlaceholder:"Search clients by name, email, or domain...",className:"flex-1"}),(0,a.jsx)(v.M,{professionalDomains:e.professionalDomains,onSubmit:eh,onAddProfessionalDomain:em,trigger:(0,a.jsx)(r.$,{type:"button",variant:"outline",children:"Add New"})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{children:"Expected Delivery"}),(0,a.jsx)(n.p,{type:"date",value:ee.expectedDelivery,onChange:e=>et({...ee,expectedDelivery:e.target.value})})]})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{children:"Order Notes"}),(0,a.jsx)(h.T,{placeholder:"Add any special instructions or notes...",value:ee.notes,onChange:e=>et({...ee,notes:e.target.value}),rows:3})]}),(0,a.jsxs)("div",{className:"space-y-4",children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)("h3",{className:"text-lg font-medium",children:"Order Items"}),(0,a.jsx)(r.$,{onClick:eo,variant:"outline",children:"Add Product"})]}),ee.items.map((e,t)=>(0,a.jsxs)("div",{className:"grid grid-cols-4 gap-4 p-4 border rounded-lg",children:[(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{children:"Product"}),(0,a.jsx)(j.Z,{value:e.productId,onValueChange:e=>eu(t,"productId",e),options:ed,placeholder:"Select product",searchPlaceholder:"Search by name, brand, or category..."})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{children:"Quantity"}),(0,a.jsx)(n.p,{type:"number",value:e.quantity,onChange:e=>eu(t,"quantity",Number.parseInt(e.target.value))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{children:"Unit Price"}),(0,a.jsx)(n.p,{type:"number",step:"0.01",value:e.unitPrice,onChange:e=>eu(t,"unitPrice",Number.parseFloat(e.target.value))})]}),(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(u.J,{children:"Total"}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsxs)("span",{className:"text-lg font-medium",children:[(e.quantity*e.unitPrice).toFixed(2)," DZD"]}),(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>ex(t),children:(0,a.jsx)(q.A,{className:"h-4 w-4"})})]})]})]},t)),ee.items.length>0&&(0,a.jsx)("div",{className:"border-t pt-4",children:(0,a.jsx)("div",{className:"flex justify-end space-y-2",children:(0,a.jsxs)("div",{className:"w-64 space-y-2",children:[(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Subtotal:"}),(0,a.jsxs)("span",{children:[ee.items.reduce((e,t)=>e+t.quantity*t.unitPrice,0).toFixed(2)," DZD"]})]}),(0,a.jsxs)("div",{className:"flex justify-between",children:[(0,a.jsx)("span",{children:"Total:"}),(0,a.jsxs)("span",{children:[ee.items.reduce((e,t)=>e+t.quantity*t.unitPrice,0).toFixed(2)," DZD"]})]})]})})})]}),(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(r.$,{variant:"outline",onClick:()=>{s?(K(!1),W(null)):M(!1),et({clientId:"",items:[],expectedDelivery:"",notes:""})},children:"Cancel"}),(0,a.jsx)(r.$,{onClick:ep,disabled:!ee.clientId||0===ee.items.length,children:s?"Update Order":"Create Order"})]})]})};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Orders"}),(0,a.jsx)("p",{className:"text-gray-600",children:"Manage customer orders and sales"})]}),(0,a.jsxs)(d.Zp,{children:[(0,a.jsxs)(d.aR,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(d.ZB,{children:"All Orders"}),(0,a.jsxs)(c.lG,{open:J,onOpenChange:M,children:[(0,a.jsx)(c.zM,{asChild:!0,children:(0,a.jsxs)(r.$,{children:[(0,a.jsx)(Z.A,{className:"mr-2 h-4 w-4"}),"Create Order"]})}),(0,a.jsxs)(c.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(c.c7,{children:(0,a.jsx)(c.L3,{children:"Create New Order"})}),(0,a.jsx)(ev,{})]})]}),(0,a.jsx)(c.lG,{open:H,onOpenChange:K,children:(0,a.jsxs)(c.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(c.c7,{children:(0,a.jsxs)(c.L3,{children:["Edit Order: ",null==V?void 0:V.orderNumber]})}),(0,a.jsx)(ev,{isEdit:!0})]})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(E.A,{className:"h-4 w-4 text-gray-400"}),(0,a.jsx)(n.p,{placeholder:"Search orders...",value:b,onChange:e=>_(e.target.value),className:"max-w-sm"})]})]}),(0,a.jsxs)(d.Wu,{children:[(0,a.jsxs)(l.XI,{children:[(0,a.jsx)(l.A0,{children:(0,a.jsxs)(l.Hj,{children:[(0,a.jsx)(p.a,{sortKey:"orderNumber",currentSort:$,onSort:es,children:"Order Number"}),(0,a.jsx)(p.a,{sortKey:"client.name",currentSort:$,onSort:es,children:"Client"}),(0,a.jsx)(l.nd,{children:"Items"}),(0,a.jsx)(p.a,{sortKey:"total",currentSort:$,onSort:es,children:"Total"}),(0,a.jsx)(l.nd,{children:"Status"}),(0,a.jsx)(p.a,{sortKey:"orderDate",currentSort:$,onSort:es,children:"Order Date"}),(0,a.jsx)(p.a,{sortKey:"expectedDelivery",currentSort:$,onSort:es,children:"Expected Delivery"}),(0,a.jsx)(l.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(l.BF,{children:en.map(e=>(0,a.jsxs)(l.Hj,{children:[(0,a.jsx)(l.nA,{className:"font-medium",children:e.orderNumber}),(0,a.jsx)(l.nA,{children:e.client.name}),(0,a.jsxs)(l.nA,{children:[e.items.length," items"]}),(0,a.jsxs)(l.nA,{children:[e.total.toFixed(2)," DZD"]}),(0,a.jsx)(l.nA,{children:(0,a.jsx)("div",{className:"flex items-center space-x-2",children:(0,a.jsxs)(x.l6,{value:e.status,onValueChange:t=>D(e.id,t),children:[(0,a.jsx)(x.bq,{className:"w-32",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[ej(e.status),(0,a.jsx)(x.yv,{})]})}),(0,a.jsxs)(x.gC,{children:[(0,a.jsx)(x.eb,{value:"pending",children:"Pending"}),(0,a.jsx)(x.eb,{value:"processing",children:"Processing"}),(0,a.jsx)(x.eb,{value:"shipped",children:"Shipped"}),(0,a.jsx)(x.eb,{value:"delivered",children:"Delivered"}),(0,a.jsx)(x.eb,{value:"cancelled",children:"Cancelled"})]})]})})}),(0,a.jsx)(l.nA,{children:e.orderDate.toLocaleDateString()}),(0,a.jsx)(l.nA,{children:e.expectedDelivery.toLocaleDateString()}),(0,a.jsx)(l.nA,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>el(e),children:(0,a.jsx)(T.A,{className:"h-4 w-4"})}),(0,a.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>{W(e),et({clientId:e.client.id,items:e.items.map(e=>({productId:e.product.id,quantity:e.quantity,unitPrice:e.unitPrice})),expectedDelivery:e.expectedDelivery.toISOString().split("T")[0],notes:e.notes||""}),K(!0)},children:(0,a.jsx)(R.A,{className:"h-4 w-4"})}),(0,a.jsxs)(o.Lt,{children:[(0,a.jsx)(o.tv,{asChild:!0,children:(0,a.jsx)(r.$,{variant:"outline",size:"sm",children:(0,a.jsx)(q.A,{className:"h-4 w-4"})})}),(0,a.jsxs)(o.EO,{children:[(0,a.jsxs)(o.wd,{children:[(0,a.jsx)(o.r7,{children:"Are you absolutely sure?"}),(0,a.jsxs)(o.$v,{children:["This will permanently delete order #",e.orderNumber,". This action cannot be undone."]})]}),(0,a.jsxs)(o.ck,{children:[(0,a.jsx)(o.Zr,{children:"Cancel"}),(0,a.jsx)(o.Rx,{onClick:()=>w(e.id),children:"Delete"})]})]})]})]})})]},e.id))})]}),(0,a.jsx)(m.d,{currentPage:A,totalPages:ei,pageSize:z,totalItems:ea.length,onPageChange:C,onPageSizeChange:e=>{L(e),C(1)}})]})]}),(0,a.jsx)(S,{order:G,open:Q,onOpenChange:Y})]})}},62525:(e,t,s)=>{"use strict";s.d(t,{A:()=>a});let a=(0,s(19946).A)("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]])},96371:(e,t,s)=>{"use strict";s.d(t,{OrderProvider:()=>d,h:()=>c});var a=s(95155),i=s(12115),r=s(31886),n=s(5749);let l=(0,i.createContext)(void 0);function d(e){let{children:t}=e,[s,d]=(0,i.useState)([]),[c,o]=(0,i.useState)(!0),[x,u]=(0,i.useState)(null);(0,i.useEffect)(()=>{(async()=>{o(!0),u(null);try{let e=((await r.N.getAll()).data||[]).map(e=>({id:e.id,orderNumber:e.order_number||"ORD-".concat(e.id.substring(0,8)),client:{id:e.client_id,name:e.client_name||"Unknown Client",email:e.client_email||"",address:e.client_address||"",phoneNumber:e.client_phone||""},items:(e.items||[]).map(e=>({id:e.id,product:{id:e.product_id,name:e.product_name||"Unknown Product",description:e.product_description||"",sellPrice:parseFloat(e.unit_price)||0},quantity:parseInt(e.quantity)||0,unitPrice:parseFloat(e.unit_price)||0,total:parseFloat(e.total)||0})),subtotal:parseFloat(e.total)||0,total:parseFloat(e.total)||0,status:e.status||"pending",orderDate:new Date(e.order_date),expectedDelivery:e.expected_delivery?new Date(e.expected_delivery):new Date,notes:e.notes||""}));d(e)}catch(e){console.error("Failed to fetch orders:",e),u(e.message||"Failed to fetch orders"),d([])}finally{o(!1)}})()},[]);let h=async e=>{try{let t=e.client_id?e:{client_id:e.client.id,order_date:e.order_date||new Date().toISOString().split("T")[0],expected_delivery:e.expectedDelivery,status:e.status||"pending",notes:e.notes,shipping_address:e.client.address,items:e.items.map(e=>({product_id:e.product.id,quantity:e.quantity,unit_price:e.unitPrice}))},s=await r.N.create(t),a={id:s.data.id,orderNumber:s.data.order_number||"ORD-".concat(s.data.id.substring(0,8)),client:{id:s.data.client_id,name:s.data.client_name||"Unknown Client",email:s.data.client_email||"",address:s.data.client_address||"",phoneNumber:s.data.client_phone||""},items:(s.data.items||[]).map(e=>({id:e.id,product:{id:e.product_id,name:e.product_name||"Unknown Product",description:e.product_description||"",sellPrice:parseFloat(e.unit_price)||0},quantity:parseInt(e.quantity)||0,unitPrice:parseFloat(e.unit_price)||0,total:parseFloat(e.total)||0})),subtotal:parseFloat(s.data.total)||0,total:parseFloat(s.data.total)||0,status:s.data.status||"pending",orderDate:new Date(s.data.order_date),expectedDelivery:s.data.expected_delivery?new Date(s.data.expected_delivery):new Date,notes:s.data.notes||""};return d(e=>[...e,a]),n.oR.success("Order #".concat(a.orderNumber," has been created successfully."),{position:"top-right",autoClose:3e3}),a}catch(e){throw console.error("Failed to add order:",e),e}},m=async(e,t)=>{try{let s=t.client_id?t:{client_id:t.client.id,order_date:t.order_date||new Date().toISOString().split("T")[0],expected_delivery:t.expectedDelivery,status:t.status||"pending",notes:t.notes,shipping_address:t.client.address,items:t.items.map(e=>({product_id:e.product.id,quantity:e.quantity,unit_price:e.unitPrice}))},a=await r.N.update(e,s),i={id:a.data.id,orderNumber:a.data.order_number||"ORD-".concat(a.data.id.substring(0,8)),client:{id:a.data.client_id,name:a.data.client_name||"Unknown Client",email:a.data.client_email||"",address:a.data.client_address||"",phoneNumber:a.data.client_phone||""},items:(a.data.items||[]).map(e=>({id:e.id,product:{id:e.product_id,name:e.product_name||"Unknown Product",description:e.product_description||"",sellPrice:parseFloat(e.unit_price)||0},quantity:parseInt(e.quantity)||0,unitPrice:parseFloat(e.unit_price)||0,total:parseFloat(e.total)||0})),subtotal:parseFloat(a.data.total)||0,total:parseFloat(a.data.total)||0,status:a.data.status||"pending",orderDate:new Date(a.data.order_date),expectedDelivery:a.data.expected_delivery?new Date(a.data.expected_delivery):new Date,notes:a.data.notes||""};return d(t=>t.map(t=>t.id===e?i:t)),i}catch(e){throw console.error("Failed to update order:",e),e}},p=async e=>{try{let t=s.find(t=>t.id===e);await r.N.delete(e),d(t=>t.filter(t=>t.id!==e)),n.oR.success("Order #".concat((null==t?void 0:t.orderNumber)||e," has been deleted successfully."),{position:"top-right",autoClose:3e3})}catch(e){throw console.error("Failed to delete order:",e),e}},j=async(e,t)=>{try{let a=await r.N.updateStatus(e,t),i=s.find(t=>t.id===e);if(!i)throw Error("Order with ID ".concat(e," not found"));let n={...i,status:a.data.status||"pending",orderDate:new Date(a.data.order_date),expectedDelivery:a.data.expected_delivery?new Date(a.data.expected_delivery):i.expectedDelivery};return d(t=>t.map(t=>t.id===e?n:t)),n}catch(e){throw console.error("Failed to update order status:",e),e}};return(0,a.jsx)(l.Provider,{value:{orders:s,loading:c,error:x,addOrder:h,updateOrder:m,deleteOrder:p,updateOrderStatus:j},children:t})}function c(){let e=(0,i.useContext)(l);if(void 0===e)throw Error("useOrders must be used within an OrderProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[4277,8543,4692,4810,203,3958,534,697,4710,8969,8441,1684,7358],()=>t(14138)),_N_E=e.O()}]);