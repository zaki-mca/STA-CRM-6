(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[9213],{62608:(e,s,n)=>{"use strict";n.r(s),n.d(s,{default:()=>f});var a=n(95155),l=n(12115),r=n(97168),d=n(89852),c=n(88524),i=n(88482),t=n(99840),o=n(82714),h=n(16559),m=n(79159),u=n(84616),x=n(89917),j=n(62525),p=n(38543),b=n(30129);function f(){let{data:e,addBrand:s,updateBrand:n,deleteBrand:f,refreshData:g}=(0,m.m)(),[N,v]=(0,l.useState)(""),[y,C]=(0,l.useState)({name:""}),[w,B]=(0,l.useState)(null),[k,R]=(0,l.useState)(!1),[A,E]=(0,l.useState)(!1),[S,$]=(0,l.useState)(null),F=e.brands.filter(e=>e.name.toLowerCase().includes(N.toLowerCase())),O=async()=>{try{if(!y.name){p.oR.error("Brand name is required");return}await s(y.name),p.oR.success("Brand added successfully"),C({name:""}),R(!1)}catch(e){p.oR.error("Failed to add brand: ".concat(e.message))}},_=async()=>{try{if(!w||!w.name){p.oR.error("Brand name is required");return}await n(w.id,{name:w.name,description:w.description||""}),p.oR.success("Brand updated successfully"),B(null),E(!1)}catch(e){p.oR.error("Failed to update brand: ".concat(e.message))}},L=async()=>{try{if(!S)return;await f(S.id),p.oR.success("Brand deleted successfully"),$(null)}catch(s){if(s.message&&s.message.includes("referenced from table")){let s=e.products.filter(e=>e.brand&&e.brand.id===(null==S?void 0:S.id)).length;p.oR.error("Cannot delete this brand because it is used by ".concat(s," product(s). Please remove the brand from all products first."))}else p.oR.error("Failed to delete brand: ".concat(s.message))}};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"Product Brands"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage your product brands"})]}),(0,a.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,a.jsx)("div",{className:"flex items-center gap-4 w-full max-w-sm",children:(0,a.jsx)(d.p,{placeholder:"Search brands...",value:N,onChange:e=>v(e.target.value),className:"max-w-sm"})}),(0,a.jsxs)("div",{className:"flex items-center gap-2",children:[(0,a.jsx)(b.e,{apiEndpoint:"".concat("http://localhost:5000/api","/brands/bulk-upload"),entityType:"brand",onUploadSuccess:e=>{0===e.length?p.oR.info("No new brands were added",{position:"top-right",autoClose:5e3}):p.oR.success((0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"font-semibold mb-1",children:["Successfully uploaded ",e.length," ",1===e.length?"brand":"brands"]}),(0,a.jsxs)("ul",{className:"list-disc pl-4 mt-1 text-sm max-h-32 overflow-auto",children:[e.slice(0,5).map((e,s)=>(0,a.jsx)("li",{children:e.name},s)),e.length>5&&(0,a.jsxs)("li",{children:["...and ",e.length-5," more"]})]})]}),{position:"top-right",autoClose:5e3,hideProgressBar:!1,closeOnClick:!0,pauseOnHover:!0,draggable:!0});let s=g();p.oR.promise(s,{pending:"Updating brands list...",success:"Brands list refreshed successfully!",error:"Failed to refresh brands"},{position:"top-right",autoClose:3e3})}}),(0,a.jsxs)(t.lG,{open:k,onOpenChange:R,children:[(0,a.jsx)(t.zM,{asChild:!0,children:(0,a.jsxs)(r.$,{className:"gap-1",children:[(0,a.jsx)(u.A,{className:"h-4 w-4"}),"Add Brand"]})}),(0,a.jsxs)(t.Cf,{children:[(0,a.jsx)(t.c7,{children:(0,a.jsx)(t.L3,{children:"Add New Brand"})}),(0,a.jsx)("div",{className:"space-y-4 py-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.J,{htmlFor:"name",children:"Brand Name"}),(0,a.jsx)(d.p,{id:"name",placeholder:"Enter brand name",value:y.name,onChange:e=>C({...y,name:e.target.value})})]})}),(0,a.jsxs)(t.Es,{children:[(0,a.jsx)(r.$,{variant:"outline",onClick:()=>R(!1),children:"Cancel"}),(0,a.jsx)(r.$,{onClick:O,children:"Save Brand"})]})]})]})]})]}),(0,a.jsxs)(i.Zp,{children:[(0,a.jsx)(i.aR,{children:(0,a.jsx)(i.ZB,{children:"Brands"})}),(0,a.jsx)(i.Wu,{children:F.length>0?(0,a.jsxs)(c.XI,{children:[(0,a.jsx)(c.A0,{children:(0,a.jsxs)(c.Hj,{children:[(0,a.jsx)(c.nd,{children:"Name"}),(0,a.jsx)(c.nd,{children:"Products Count"}),(0,a.jsx)(c.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(c.BF,{children:F.map(s=>{let n=e.products.filter(e=>e.brand&&e.brand.id===s.id).length;return(0,a.jsxs)(c.Hj,{children:[(0,a.jsx)(c.nA,{className:"font-medium",children:s.name}),(0,a.jsx)(c.nA,{children:n}),(0,a.jsx)(c.nA,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end gap-2",children:[(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>{B(s),E(!0)},children:[(0,a.jsx)(x.A,{className:"h-4 w-4"}),(0,a.jsx)("span",{className:"sr-only",children:"Edit"})]}),(0,a.jsxs)(h.Lt,{children:[(0,a.jsx)(h.tv,{asChild:!0,children:(0,a.jsxs)(r.$,{variant:"outline",size:"sm",onClick:()=>$(s),children:[(0,a.jsx)(j.A,{className:"h-4 w-4 text-red-500"}),(0,a.jsx)("span",{className:"sr-only",children:"Delete"})]})}),(0,a.jsxs)(h.EO,{children:[(0,a.jsxs)(h.wd,{children:[(0,a.jsx)(h.r7,{children:"Are you absolutely sure?"}),(0,a.jsxs)(h.$v,{children:['This will permanently delete the brand "',s.name,'".',n>0&&(0,a.jsxs)("span",{className:"mt-2 block text-amber-600",children:["Warning: This brand is used by ",n," product(s). You must remove the brand from these products before deleting."]}),0===n&&(0,a.jsx)("span",{className:"block mt-2",children:"This action cannot be undone."})]})]}),(0,a.jsxs)(h.ck,{children:[(0,a.jsx)(h.Zr,{onClick:()=>$(null),children:"Cancel"}),(0,a.jsx)(h.Rx,{onClick:L,disabled:n>0,children:"Delete"})]})]})]})]})})]},s.id)})})]}):(0,a.jsx)("div",{className:"text-center py-10",children:(0,a.jsx)("p",{className:"text-muted-foreground",children:"No brands found"})})})]}),(0,a.jsx)(t.lG,{open:A,onOpenChange:E,children:(0,a.jsxs)(t.Cf,{children:[(0,a.jsx)(t.c7,{children:(0,a.jsx)(t.L3,{children:"Edit Brand"})}),(0,a.jsx)("div",{className:"space-y-4 py-4",children:(0,a.jsxs)("div",{className:"space-y-2",children:[(0,a.jsx)(o.J,{htmlFor:"edit-name",children:"Brand Name"}),(0,a.jsx)(d.p,{id:"edit-name",placeholder:"Enter brand name",value:(null==w?void 0:w.name)||"",onChange:e=>B(w?{...w,name:e.target.value}:null)})]})}),(0,a.jsxs)(t.Es,{children:[(0,a.jsx)(r.$,{variant:"outline",onClick:()=>E(!1),children:"Cancel"}),(0,a.jsx)(r.$,{onClick:_,children:"Update Brand"})]})]})})]})}},95777:(e,s,n)=>{Promise.resolve().then(n.bind(n,62608))}},e=>{var s=s=>e(e.s=s);e.O(0,[4277,8543,4692,8712,697,2585,8441,1684,7358],()=>s(95777)),_N_E=e.O()}]);