(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[5021],{19339:(e,t,s)=>{"use strict";s.r(t),s.d(t,{default:()=>R});var a=s(95155),r=s(12115),n=s(97168),d=s(89852),i=s(88145),l=s(88524),c=s(88482),o=s(49251),x=s(58642),m=s(18969),u=s(99840),h=s(79159),p=s(96371),j=s(40646),g=s(14186),N=s(85339),f=s(57434),v=s(69074),y=s(55868),b=s(81586),A=s(6740);function D(e){let{client:t,open:s,onOpenChange:r}=e,{data:n}=(0,h.m)(),{orders:d}=(0,p.h)(),o=u.L3;if(!t)return null;let x=d.filter(e=>e.client.name==="".concat(t.firstName," ").concat(t.lastName)||e.client.email===t.email),m=x.reduce((e,t)=>e+t.total,0),D=x.filter(e=>"delivered"===e.status),C=x.filter(e=>"delivered"!==e.status&&"cancelled"!==e.status),w=e=>{if(!e)return"N/A";let t=new Date,s=t.getFullYear()-e.getFullYear(),a=t.getMonth()-e.getMonth();return a<0||0===a&&t.getDate()<e.getDate()?s-1:s},_=e=>{switch(e){case"delivered":return(0,a.jsx)(j.A,{className:"h-4 w-4 text-green-600 dark:text-green-300"});case"shipped":return(0,a.jsx)(g.A,{className:"h-4 w-4 text-blue-600 dark:text-blue-300"});case"cancelled":return(0,a.jsx)(N.A,{className:"h-4 w-4 text-red-600 dark:text-red-300"});default:return(0,a.jsx)(f.A,{className:"h-4 w-4 text-gray-600 dark:text-gray-300"})}},k=e=>{switch(e){case"delivered":return"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-100";case"shipped":return"bg-blue-100 text-blue-800 dark:bg-blue-900 dark:text-blue-100";case"cancelled":return"bg-red-100 text-red-800 dark:bg-red-900 dark:text-red-100";default:return"bg-gray-100 text-gray-800 dark:bg-gray-800 dark:text-gray-100"}};return(0,a.jsx)(u.lG,{open:s,onOpenChange:r,children:(0,a.jsxs)(u.Cf,{className:"max-w-4xl max-h-[90vh] overflow-y-auto",children:[(0,a.jsx)(u.c7,{children:(0,a.jsx)(o,{className:"flex items-center space-x-2",children:(0,a.jsxs)("span",{children:["Client Details: ",t.gender," ",t.firstName," ",t.lastName]})})}),(0,a.jsxs)("div",{className:"space-y-6",children:[(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{children:(0,a.jsx)(c.ZB,{children:"Client Information"})}),(0,a.jsxs)(c.Wu,{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Full Name"}),(0,a.jsxs)("p",{className:"text-lg font-semibold",children:[t.gender," ",t.firstName," ",t.lastName]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Email"}),(0,a.jsx)("p",{children:t.email})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Phone"}),(0,a.jsx)("p",{children:t.phoneNumber})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Age"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(v.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{children:"N/A"===w(t.birthDate)?"N/A":"".concat(w(t.birthDate)," years old")})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Professional Domain"}),(0,a.jsxs)("div",{className:"flex flex-col space-y-1",children:[(0,a.jsx)(i.E,{variant:"outline",children:t.professionalDomain}),t.professionalDomainCode&&(0,a.jsxs)("div",{className:"flex items-center space-x-1 mt-1",children:[(0,a.jsx)("span",{className:"text-xs text-muted-foreground",children:"Payment Code:"}),(0,a.jsx)("span",{className:"font-mono text-xs bg-purple-50 px-2 py-1 rounded dark:bg-gray-800 dark:text-gray-100",children:t.professionalDomainCode})]})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Annual Revenue"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-green-600 dark:text-green-300"}),(0,a.jsxs)("span",{className:"font-medium text-green-600 dark:text-green-300",children:[t.revenue.toLocaleString()," DZD"]})]})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Address"}),(0,a.jsx)("p",{children:t.address})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Member Since"}),(0,a.jsx)("p",{children:t.createdAt?t.createdAt.toLocaleDateString():"N/A"})]})]})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{children:(0,a.jsx)(c.ZB,{className:"flex items-center space-x-2",children:(0,a.jsx)("span",{children:"\uD83C\uDDE9\uD83C\uDDFF Algeria CCP Account Information"})})}),(0,a.jsxs)(c.Wu,{className:"grid grid-cols-2 gap-4",children:[(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"CCP Account Number"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 text-blue-600 dark:text-blue-300"}),(0,a.jsx)("span",{className:"font-mono text-sm",children:t.ccpAccount||"N/A"})]})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Cl\xe9 CCP"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(A.A,{className:"h-4 w-4 text-purple-600 dark:text-purple-300"}),(0,a.jsx)("span",{className:"font-mono text-sm bg-purple-50 px-2 py-1 rounded font-bold dark:bg-gray-800 dark:text-gray-100",children:t.cle||"N/A"})]})]}),(0,a.jsxs)("div",{className:"col-span-2",children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"RIP (Relev\xe9 d'Identit\xe9 Postal)"}),(0,a.jsx)("div",{className:"font-mono text-xs bg-gray-50 px-2 py-1 rounded dark:bg-gray-800 dark:text-gray-100",children:t.rip||"N/A"})]}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"RIP Cl\xe9"}),(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(f.A,{className:"h-4 w-4 text-orange-600 dark:text-orange-300"}),(0,a.jsx)("span",{className:"font-mono text-sm bg-orange-50 px-2 py-1 rounded font-bold dark:bg-gray-800 dark:text-gray-100",children:t.ripCle||"N/A"})]})]})]})]}),(0,a.jsxs)("div",{className:"grid grid-cols-3 gap-4",children:[(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(y.A,{className:"h-8 w-8 text-green-600 dark:text-green-300"}),(0,a.jsxs)("div",{children:[(0,a.jsxs)("p",{className:"text-2xl font-bold",children:[m.toLocaleString()," DZD"]}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Total Orders Value"})]})]})})}),(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(j.A,{className:"h-8 w-8 text-green-600 dark:text-green-300"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:D.length}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Completed Orders"})]})]})})}),(0,a.jsx)(c.Zp,{children:(0,a.jsx)(c.Wu,{className:"p-6",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(g.A,{className:"h-8 w-8 text-orange-600 dark:text-orange-300"}),(0,a.jsxs)("div",{children:[(0,a.jsx)("p",{className:"text-2xl font-bold",children:C.length}),(0,a.jsx)("p",{className:"text-sm text-muted-foreground",children:"Pending Orders"})]})]})})})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsx)(c.aR,{children:(0,a.jsx)(c.ZB,{children:"Orders History"})}),(0,a.jsx)(c.Wu,{children:x.length>0?(0,a.jsxs)(l.XI,{children:[(0,a.jsx)(l.A0,{children:(0,a.jsxs)(l.Hj,{children:[(0,a.jsx)(l.nd,{children:"Order Number"}),(0,a.jsx)(l.nd,{children:"Date"}),(0,a.jsx)(l.nd,{children:"Items"}),(0,a.jsx)(l.nd,{children:"Amount"}),(0,a.jsx)(l.nd,{children:"Status"}),(0,a.jsx)(l.nd,{children:"Expected Delivery"})]})}),(0,a.jsx)(l.BF,{children:x.map(e=>(0,a.jsxs)(l.Hj,{children:[(0,a.jsx)(l.nA,{className:"font-medium",children:e.orderNumber||"ORD-".concat(e.id.substring(0,8))}),(0,a.jsx)(l.nA,{children:e.orderDate?e.orderDate.toLocaleDateString():"N/A"}),(0,a.jsxs)(l.nA,{children:[e.items.length," items"]}),(0,a.jsxs)(l.nA,{className:"font-semibold",children:[e.total.toLocaleString()," DZD"]}),(0,a.jsx)(l.nA,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[_(e.status),(0,a.jsx)(i.E,{className:k(e.status),children:e.status.charAt(0).toUpperCase()+e.status.slice(1)})]})}),(0,a.jsx)(l.nA,{children:e.expectedDelivery?e.expectedDelivery.toLocaleDateString():"N/A"})]},e.id))})]}):(0,a.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,a.jsx)(f.A,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground/50"}),(0,a.jsx)("p",{children:"No orders found for this client"})]})})]})]})]})})}var C=s(20485),w=s(5749),_=s(84616),k=s(47924),P=s(29621),S=s(92657),F=s(13717),O=s(62525);function R(){let{data:e,addClient:t,updateClient:s,deleteClient:u,addProfessionalDomain:p}=(0,h.m)(),[j,g]=(0,r.useState)(""),[N,R]=(0,r.useState)(1),[L,I]=(0,r.useState)(10),[E,Z]=(0,r.useState)(null),[q,M]=(0,r.useState)(null),[U,W]=(0,r.useState)(!1),[B,K]=(0,r.useState)(!1),[T,$]=(0,r.useState)(null),z=e=>{let t="asc";E&&E.key===e&&"asc"===E.direction&&(t="desc"),Z({key:e,direction:t})},H=[...e.clients.filter(e=>"".concat(e.firstName," ").concat(e.lastName).toLowerCase().includes(j.toLowerCase())||e.email.toLowerCase().includes(j.toLowerCase())||e.professionalDomain.toLowerCase().includes(j.toLowerCase())||e.ccpAccount.toLowerCase().includes(j.toLowerCase())||e.rip.toLowerCase().includes(j.toLowerCase()))].sort((e,t)=>{if(!E)return 0;let s=e[E.key],a=t[E.key];return void 0===s&&void 0===a?0:void 0===s?"asc"===E.direction?-1:1:void 0===a?"asc"===E.direction?1:-1:s<a?"asc"===E.direction?-1:1:s>a?"asc"===E.direction?1:-1:0}),Y=Math.ceil(H.length/L),X=(N-1)*L,G=H.slice(X,X+L),V=e=>{if(!e)return"N/A";let t=new Date,s=t.getFullYear()-e.getFullYear(),a=t.getMonth()-e.getMonth();return a<0||0===a&&t.getDate()<e.getDate()?s-1:s},J=e=>{M(e),W(!0)},Q=e=>{p({name:e})},ee=e=>{$(e),K(!0)},et=async()=>{if(T)try{await u(T),w.oR.success("Client deleted successfully",{position:"top-right",autoClose:3e3}),$(null)}catch(e){console.error("Error deleting client:",e),e.message&&e.message.includes("still referenced from table")?e.message.includes("invoices")?w.oR.error("Cannot delete this client because they have associated invoices. Please delete the invoices first.",{position:"top-right",autoClose:5e3}):e.message.includes("orders")?w.oR.error("Cannot delete this client because they have associated orders. Please delete the orders first.",{position:"top-right",autoClose:5e3}):e.message.includes("client_logs")?w.oR.error("Cannot delete this client because they have associated logs. Please delete the logs first.",{position:"top-right",autoClose:5e3}):w.oR.error("Cannot delete this client because they are referenced by other records in the system.",{position:"top-right",autoClose:5e3}):w.oR.error("Failed to delete client: "+(e.message||"Unknown error"),{position:"top-right",autoClose:5e3})}};return(0,a.jsxs)("div",{className:"p-6",children:[(0,a.jsxs)("div",{className:"mb-6",children:[(0,a.jsx)("h1",{className:"text-3xl font-bold",children:"\uD83C\uDDE9\uD83C\uDDFF Clients"}),(0,a.jsx)("p",{className:"text-muted-foreground",children:"Manage your customers and Algeria CCP accounts"})]}),(0,a.jsxs)(c.Zp,{children:[(0,a.jsxs)(c.aR,{children:[(0,a.jsxs)("div",{className:"flex justify-between items-center",children:[(0,a.jsx)(c.ZB,{children:"All Clients"}),(0,a.jsx)(m.M,{professionalDomains:e.professionalDomains,onSubmit:t,onAddProfessionalDomain:Q,trigger:(0,a.jsxs)(n.$,{children:[(0,a.jsx)(_.A,{className:"mr-2 h-4 w-4"}),"Add Client"]})})]}),(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)(k.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)(d.p,{placeholder:"Search clients...",value:j,onChange:e=>g(e.target.value),className:"max-w-sm"})]})]}),(0,a.jsxs)(c.Wu,{children:[(0,a.jsxs)(l.XI,{children:[(0,a.jsx)(l.A0,{children:(0,a.jsxs)(l.Hj,{children:[(0,a.jsx)(x.a,{sortKey:"firstName",currentSort:E,onSort:z,children:"Name"}),(0,a.jsx)(x.a,{sortKey:"email",currentSort:E,onSort:z,children:"Email"}),(0,a.jsx)(x.a,{sortKey:"phoneNumber",currentSort:E,onSort:z,children:"Phone"}),(0,a.jsx)(l.nd,{children:"Age"}),(0,a.jsx)(l.nd,{children:"Professional Domain"}),(0,a.jsx)(l.nd,{children:"Domain Code"}),(0,a.jsx)(l.nd,{children:"Revenue"}),(0,a.jsx)(l.nd,{children:"CCP Account"}),(0,a.jsx)(l.nd,{children:"Cl\xe9 CCP"}),(0,a.jsx)(l.nd,{children:"RIP"}),(0,a.jsx)(l.nd,{children:"RIP Cl\xe9"}),(0,a.jsx)(l.nd,{children:"Address"}),(0,a.jsx)(x.a,{sortKey:"createdAt",currentSort:E,onSort:z,children:"Created"}),(0,a.jsx)(l.nd,{className:"text-right",children:"Actions"})]})}),(0,a.jsx)(l.BF,{children:G.map(t=>(0,a.jsxs)(l.Hj,{children:[(0,a.jsx)(l.nA,{className:"font-medium",children:(0,a.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,a.jsx)("span",{className:"text-xs bg-muted px-2 py-1 rounded",children:t.gender}),(0,a.jsx)("span",{children:"".concat(t.firstName," ").concat(t.lastName)})]})}),(0,a.jsx)(l.nA,{children:t.email}),(0,a.jsx)(l.nA,{children:t.phoneNumber}),(0,a.jsx)(l.nA,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(v.A,{className:"h-4 w-4 text-muted-foreground"}),(0,a.jsx)("span",{children:"N/A"===V(t.birthDate)?"N/A":"".concat(V(t.birthDate)," years")})]})}),(0,a.jsx)(l.nA,{children:(0,a.jsx)(i.E,{variant:"outline",children:t.professionalDomain})}),(0,a.jsx)(l.nA,{children:t.professionalDomainCode?(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(P.A,{className:"h-4 w-4 text-purple-600 dark:text-purple-300"}),(0,a.jsx)("span",{className:"font-mono text-sm bg-purple-50 px-2 py-1 rounded dark:bg-gray-800 dark:text-gray-100",children:t.professionalDomainCode})]}):(0,a.jsx)("span",{className:"text-muted-foreground",children:"No code"})}),(0,a.jsx)(l.nA,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(y.A,{className:"h-4 w-4 text-green-600 dark:text-green-300"}),(0,a.jsxs)("span",{className:"font-medium text-green-600 dark:text-green-300",children:[t.revenue?t.revenue.toLocaleString():"0"," DZD"]})]})}),(0,a.jsx)(l.nA,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(b.A,{className:"h-4 w-4 text-blue-600 dark:text-blue-300"}),(0,a.jsx)("span",{className:"font-mono text-sm",children:t.ccpAccount||"N/A"})]})}),(0,a.jsx)(l.nA,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(A.A,{className:"h-4 w-4 text-purple-600 dark:text-purple-300"}),(0,a.jsx)("span",{className:"font-mono text-sm bg-purple-50 px-2 py-1 rounded font-bold dark:bg-gray-800 dark:text-gray-100",children:t.cle||"N/A"})]})}),(0,a.jsx)(l.nA,{children:(0,a.jsx)("div",{className:"font-mono text-xs bg-gray-50 px-2 py-1 rounded max-w-[140px] truncate dark:bg-gray-800 dark:text-gray-100",children:t.rip||"N/A"})}),(0,a.jsx)(l.nA,{children:(0,a.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,a.jsx)(f.A,{className:"h-4 w-4 text-orange-600 dark:text-orange-300"}),(0,a.jsx)("span",{className:"font-mono text-sm bg-orange-50 px-2 py-1 rounded font-bold dark:bg-gray-800 dark:text-gray-100",children:t.ripCle||"N/A"})]})}),(0,a.jsx)(l.nA,{className:"max-w-xs truncate",children:t.address}),(0,a.jsx)(l.nA,{children:t.createdAt?t.createdAt.toLocaleDateString():"N/A"}),(0,a.jsx)(l.nA,{className:"text-right",children:(0,a.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,a.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>J(t),children:(0,a.jsx)(S.A,{className:"h-4 w-4"})}),(0,a.jsx)(m.M,{client:t,professionalDomains:e.professionalDomains,onSubmit:e=>s(t.id,e),onAddProfessionalDomain:Q,trigger:(0,a.jsx)(n.$,{variant:"outline",size:"sm",children:(0,a.jsx)(F.A,{className:"h-4 w-4"})})}),(0,a.jsx)(n.$,{variant:"outline",size:"sm",onClick:()=>ee(t.id),children:(0,a.jsx)(O.A,{className:"h-4 w-4"})})]})})]},t.id))})]}),(0,a.jsx)(o.d,{currentPage:N,totalPages:Y,pageSize:L,totalItems:H.length,onPageChange:R,onPageSizeChange:e=>{I(e),R(1)}})]})]}),(0,a.jsx)(D,{client:q,open:U,onOpenChange:W}),(0,a.jsx)(C.K,{title:"Delete Client",description:"Are you sure you want to delete this client? This action cannot be undone.",open:B,onOpenChange:K,onConfirm:et,confirmText:"Delete",cancelText:"Cancel"})]})}},20485:(e,t,s)=>{"use strict";s.d(t,{K:()=>d});var a=s(95155);s(12115);var r=s(16559),n=s(97168);function d(e){let{title:t,description:s,open:d,onOpenChange:i,onConfirm:l,confirmText:c="Confirm",cancelText:o="Cancel",variant:x="destructive"}=e;return(0,a.jsx)(r.Lt,{open:d,onOpenChange:i,children:(0,a.jsxs)(r.EO,{children:[(0,a.jsxs)(r.wd,{children:[(0,a.jsx)(r.r7,{children:t}),(0,a.jsx)(r.$v,{children:s})]}),(0,a.jsxs)(r.ck,{children:[(0,a.jsx)(r.Zr,{children:o}),(0,a.jsx)(r.Rx,{asChild:!0,children:(0,a.jsx)(n.$,{variant:x,onClick:l,children:c})})]})]})})}},79755:(e,t,s)=>{Promise.resolve().then(s.bind(s,19339))},96371:(e,t,s)=>{"use strict";s.d(t,{OrderProvider:()=>l,h:()=>c});var a=s(95155),r=s(12115),n=s(31886),d=s(5749);let i=(0,r.createContext)(void 0);function l(e){let{children:t}=e,[s,l]=(0,r.useState)([]),[c,o]=(0,r.useState)(!0),[x,m]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{o(!0),m(null);try{let e=((await n.N.getAll()).data||[]).map(e=>({id:e.id,orderNumber:e.order_number||"ORD-".concat(e.id.substring(0,8)),client:{id:e.client_id,name:e.client_name||"Unknown Client",email:e.client_email||"",address:e.client_address||"",phoneNumber:e.client_phone||""},items:(e.items||[]).map(e=>({id:e.id,product:{id:e.product_id,name:e.product_name||"Unknown Product",description:e.product_description||"",sellPrice:parseFloat(e.unit_price)||0},quantity:parseInt(e.quantity)||0,unitPrice:parseFloat(e.unit_price)||0,total:parseFloat(e.total)||0})),subtotal:parseFloat(e.total)||0,total:parseFloat(e.total)||0,status:e.status||"pending",orderDate:new Date(e.order_date),expectedDelivery:e.expected_delivery?new Date(e.expected_delivery):new Date,notes:e.notes||""}));l(e)}catch(e){console.error("Failed to fetch orders:",e),m(e.message||"Failed to fetch orders"),l([])}finally{o(!1)}})()},[]);let u=async e=>{try{let t=e.client_id?e:{client_id:e.client.id,order_date:e.order_date||new Date().toISOString().split("T")[0],expected_delivery:e.expectedDelivery,status:e.status||"pending",notes:e.notes,shipping_address:e.client.address,items:e.items.map(e=>({product_id:e.product.id,quantity:e.quantity,unit_price:e.unitPrice}))},s=await n.N.create(t),a={id:s.data.id,orderNumber:s.data.order_number||"ORD-".concat(s.data.id.substring(0,8)),client:{id:s.data.client_id,name:s.data.client_name||"Unknown Client",email:s.data.client_email||"",address:s.data.client_address||"",phoneNumber:s.data.client_phone||""},items:(s.data.items||[]).map(e=>({id:e.id,product:{id:e.product_id,name:e.product_name||"Unknown Product",description:e.product_description||"",sellPrice:parseFloat(e.unit_price)||0},quantity:parseInt(e.quantity)||0,unitPrice:parseFloat(e.unit_price)||0,total:parseFloat(e.total)||0})),subtotal:parseFloat(s.data.total)||0,total:parseFloat(s.data.total)||0,status:s.data.status||"pending",orderDate:new Date(s.data.order_date),expectedDelivery:s.data.expected_delivery?new Date(s.data.expected_delivery):new Date,notes:s.data.notes||""};return l(e=>[...e,a]),d.oR.success("Order #".concat(a.orderNumber," has been created successfully."),{position:"top-right",autoClose:3e3}),a}catch(e){throw console.error("Failed to add order:",e),e}},h=async(e,t)=>{try{let s=t.client_id?t:{client_id:t.client.id,order_date:t.order_date||new Date().toISOString().split("T")[0],expected_delivery:t.expectedDelivery,status:t.status||"pending",notes:t.notes,shipping_address:t.client.address,items:t.items.map(e=>({product_id:e.product.id,quantity:e.quantity,unit_price:e.unitPrice}))},a=await n.N.update(e,s),r={id:a.data.id,orderNumber:a.data.order_number||"ORD-".concat(a.data.id.substring(0,8)),client:{id:a.data.client_id,name:a.data.client_name||"Unknown Client",email:a.data.client_email||"",address:a.data.client_address||"",phoneNumber:a.data.client_phone||""},items:(a.data.items||[]).map(e=>({id:e.id,product:{id:e.product_id,name:e.product_name||"Unknown Product",description:e.product_description||"",sellPrice:parseFloat(e.unit_price)||0},quantity:parseInt(e.quantity)||0,unitPrice:parseFloat(e.unit_price)||0,total:parseFloat(e.total)||0})),subtotal:parseFloat(a.data.total)||0,total:parseFloat(a.data.total)||0,status:a.data.status||"pending",orderDate:new Date(a.data.order_date),expectedDelivery:a.data.expected_delivery?new Date(a.data.expected_delivery):new Date,notes:a.data.notes||""};return l(t=>t.map(t=>t.id===e?r:t)),r}catch(e){throw console.error("Failed to update order:",e),e}},p=async e=>{try{let t=s.find(t=>t.id===e);await n.N.delete(e),l(t=>t.filter(t=>t.id!==e)),d.oR.success("Order #".concat((null==t?void 0:t.orderNumber)||e," has been deleted successfully."),{position:"top-right",autoClose:3e3})}catch(e){throw console.error("Failed to delete order:",e),e}},j=async(e,t)=>{try{let a=await n.N.updateStatus(e,t),r=s.find(t=>t.id===e);if(!r)throw Error("Order with ID ".concat(e," not found"));let d={...r,status:a.data.status||"pending",orderDate:new Date(a.data.order_date),expectedDelivery:a.data.expected_delivery?new Date(a.data.expected_delivery):r.expectedDelivery};return l(t=>t.map(t=>t.id===e?d:t)),d}catch(e){throw console.error("Failed to update order status:",e),e}};return(0,a.jsx)(i.Provider,{value:{orders:s,loading:c,error:x,addOrder:u,updateOrder:h,deleteOrder:p,updateOrderStatus:j},children:t})}function c(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useOrders must be used within an OrderProvider");return e}}},e=>{var t=t=>e(e.s=t);e.O(0,[4277,8543,4692,4810,203,3958,2854,697,4710,8969,8441,1684,7358],()=>t(79755)),_N_E=e.O()}]);