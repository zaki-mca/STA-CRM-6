(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[8668],{4192:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>K});var l=t(95155),n=t(12115),a=t(97168),i=t(89852),c=t(88145),r=t(88524),o=t(88482),d=t(99840),x=t(16559),m=t(82714),h=t(99474),u=t(95784),j=t(49251),g=t(58642),f=t(68780),N=t(18969),p=t(79159),v=t(40646),w=t(14186),A=t(69074),C=t(17580),y=t(71007),D=t(47924),S=t(28883),b=t(17576),k=t(55868),L=t(57434);function I(e){var s;let{log:t,open:a,onOpenChange:x}=e,{data:m}=(0,p.m)(),[h,f]=(0,n.useState)(""),[N,I]=(0,n.useState)(1),[P,F]=(0,n.useState)(5),[E,R]=(0,n.useState)({key:"name",direction:"asc"}),[Z,U]=(0,n.useState)("all"),B=d.L3,K=u.bq,O=u.gC,T=u.eb;if(!t)return null;console.log("Log data in modal:",t),console.log("Total clients from log:",t.totalClients),console.log("Clients array:",t.clients);let z=e=>{let s="asc";E&&E.key===e&&"asc"===E.direction&&(s="desc"),R({key:e,direction:s})};console.log("log clients in modal:",t.clients),console.log("log totalClients:",t.totalClients);let M=(t.clients&&t.clients.length>0?t.clients:t.totalClients>0?Array.from({length:t.totalClients},(e,s)=>({id:"placeholder-".concat(Date.now(),"-").concat(s),clientId:"unknown-".concat(Date.now(),"-").concat(s),clientName:"Unknown Client",clientEmail:"",addedAt:new Date,notes:""})):[]).map(e=>{console.log("Processing log client:",e);let s=m.clients.find(s=>s.id===e.clientId);!s&&e.clientName&&(s=m.clients.find(s=>"".concat(s.firstName," ").concat(s.lastName).toLowerCase()===e.clientName.toLowerCase())),console.log("Found full client data:",s?"Yes":"No",s);let t="Unknown",l="";if(e.clientName){let s=e.clientName.split(" ");s.length>0&&(t=s[0],l=s.slice(1).join(" "))}return{...e,fullData:s||{id:e.clientId,firstName:t,lastName:l,email:e.clientEmail||"No email",phoneNumber:"N/A",gender:"N/A",birthDate:new Date,professionalDomain:"Unknown",revenue:0}}});console.log("Clients with full data:",M),console.log("Original clients count:",null===(s=t.clients)||void 0===s?void 0:s.length),console.log("Processed clients count:",M.length),console.log("clientsWithFullData before filtering:",M);let $=[...M.filter(e=>{if(""===h&&"all"===Z)return!0;let s=e.fullData,t=""===h||(s.firstName||"").toLowerCase().includes(h.toLowerCase())||(s.lastName||"").toLowerCase().includes(h.toLowerCase())||(s.email||"").toLowerCase().includes(h.toLowerCase())||(s.phoneNumber||"").includes(h),l=s.professionalDomain||"",n="all"===Z||l===Z;return t&&n})].sort((e,s)=>{let t,l;if(!E)return 0;switch(E.key){case"name":t="".concat(e.fullData.firstName," ").concat(e.fullData.lastName),l="".concat(s.fullData.firstName," ").concat(s.fullData.lastName);break;case"email":t=e.fullData.email,l=s.fullData.email;break;case"phone":t=e.fullData.phoneNumber,l=s.fullData.phoneNumber;break;case"domain":t=e.fullData.professionalDomain,l=s.fullData.professionalDomain;break;case"revenue":t=e.fullData.revenue,l=s.fullData.revenue;break;case"addedAt":t=e.addedAt,l=s.addedAt;break;default:return 0}return t<l?"asc"===E.direction?-1:1:t>l?"asc"===E.direction?1:-1:0}),W=Math.ceil($.length/P),H=(N-1)*P,Y=$.slice(H,H+P),_=[...new Set(M.map(e=>e.fullData.professionalDomain))],V=t.clients||[],X=M.length,q=e=>e?e.toLocaleDateString():"Unknown date",G=e=>e?e.toLocaleString():"Unknown time",J=e=>{if(!e)return"N/A";let s=new Date,t=s.getFullYear()-e.getFullYear(),l=s.getMonth()-e.getMonth();return l<0||0===l&&s.getDate()<e.getDate()?t-1:t};return(0,l.jsx)(d.lG,{open:a,onOpenChange:x,children:(0,l.jsxs)(d.Cf,{className:"max-w-7xl max-h-[90vh] overflow-y-auto",children:[(0,l.jsx)(d.c7,{children:(0,l.jsxs)(B,{className:"flex items-center space-x-2",children:[(0,l.jsx)(A.A,{className:"h-5 w-5"}),(0,l.jsxs)("span",{children:["Client Daily Log - ",q(t.date)]})]})}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)(o.Zp,{children:[(0,l.jsx)(o.aR,{children:(0,l.jsx)(o.ZB,{children:"Log Summary"})}),(0,l.jsxs)(o.Wu,{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Date"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(A.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{className:"text-lg font-semibold",children:q(t.date)})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Status"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[t.isClosed?(0,l.jsx)(v.A,{className:"h-4 w-4 text-green-600"}):(0,l.jsx)(w.A,{className:"h-4 w-4 text-orange-600"}),(0,l.jsx)(c.E,{className:t.isClosed?"bg-green-100 text-green-800 dark:bg-green-900 dark:text-green-200":"bg-orange-100 text-orange-800 dark:bg-orange-900 dark:text-orange-200",children:t.isClosed?"Closed":"Open"})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Total Clients"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(C.A,{className:"h-4 w-4 text-blue-600"}),(0,l.jsx)("span",{className:"text-lg font-semibold text-blue-600",children:t.totalClients||0})]})]}),(0,l.jsxs)("div",{children:[(0,l.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Created By"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{children:t.createdBy||"Unknown"})]})]}),t.closedAt&&(0,l.jsxs)("div",{className:"col-span-full",children:[(0,l.jsx)("p",{className:"text-sm font-medium text-muted-foreground",children:"Closed At"}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(w.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{children:G(t.closedAt)})]})]})]})]}),(0,l.jsxs)(o.Zp,{children:[(0,l.jsxs)(o.aR,{children:[(0,l.jsxs)(o.ZB,{children:["Clients Added (",t.totalClients||X,")"]}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 flex-1",children:[(0,l.jsx)(D.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)(i.p,{placeholder:"Search clients...",value:h,onChange:e=>f(e.target.value),className:"max-w-sm"})]}),(0,l.jsxs)(u.l6,{value:Z,onValueChange:U,children:[(0,l.jsx)(K,{className:"w-full sm:w-[200px]",children:(0,l.jsx)(u.yv,{placeholder:"Filter by domain"})}),(0,l.jsxs)(O,{children:[(0,l.jsx)(T,{value:"all",children:"All Domains"}),_.map(e=>e?(0,l.jsx)(T,{value:e,children:e},e):null)]})]})]})]}),(0,l.jsx)(o.Wu,{children:M.length>0?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(r.XI,{children:[(0,l.jsx)(r.A0,{children:(0,l.jsxs)(r.Hj,{children:[(0,l.jsx)(g.a,{sortKey:"name",currentSort:E,onSort:z,children:"Client Name"}),(0,l.jsx)(g.a,{sortKey:"email",currentSort:E,onSort:z,children:"Email"}),(0,l.jsx)(g.a,{sortKey:"phone",currentSort:E,onSort:z,children:"Phone"}),(0,l.jsx)(r.nd,{children:"Age"}),(0,l.jsx)(g.a,{sortKey:"domain",currentSort:E,onSort:z,children:"Professional Domain"}),(0,l.jsx)(g.a,{sortKey:"revenue",currentSort:E,onSort:z,children:"Revenue"}),(0,l.jsx)(g.a,{sortKey:"addedAt",currentSort:E,onSort:z,children:"Added At"}),(0,l.jsx)(r.nd,{children:"Notes"})]})}),(0,l.jsx)(r.BF,{children:Y.map((e,s)=>{let t=e.fullData;return(0,l.jsxs)(r.Hj,{children:[(0,l.jsx)(r.nA,{className:"font-medium",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(y.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsxs)("div",{children:[(0,l.jsx)("span",{className:"text-xs bg-muted px-2 py-1 rounded mr-2",children:t.gender||"N/A"}),(0,l.jsxs)("span",{children:[t.firstName||""," ",t.lastName||""]})]})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(S.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{children:t.email||"No email"})]})}),(0,l.jsx)(r.nA,{children:t.phoneNumber||"N/A"}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)(A.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{children:t.birthDate?"N/A"===J(t.birthDate)?"N/A":"".concat(J(t.birthDate)," years"):"N/A"})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(b.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)(c.E,{variant:"outline",children:t.professionalDomain||"Unknown"})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)(k.A,{className:"h-4 w-4 text-green-600"}),(0,l.jsxs)("span",{className:"font-medium text-green-600",children:[(t.revenue||0).toLocaleString()," DZD"]})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(w.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{children:G(e.addedAt)})]})}),(0,l.jsx)(r.nA,{children:e.notes?(0,l.jsxs)("div",{className:"flex items-start space-x-2",children:[(0,l.jsx)(L.A,{className:"h-4 w-4 text-muted-foreground mt-0.5"}),(0,l.jsx)("span",{className:"text-sm",children:e.notes})]}):(0,l.jsx)("span",{className:"text-muted-foreground",children:"No notes"})})]},e.id||"client-".concat(s,"-").concat(t.id))})})]})}),(0,l.jsx)(j.d,{currentPage:N,totalPages:W,pageSize:P,totalItems:$.length,onPageChange:I,onPageSizeChange:e=>{F(e),I(1)}})]}):(0,l.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,l.jsx)(C.A,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground/50"}),(0,l.jsx)("p",{children:"No clients added to this log yet"})]})})]}),(0,l.jsxs)(o.Zp,{children:[(0,l.jsx)(o.aR,{children:(0,l.jsx)(o.ZB,{children:"Activity Timeline"})}),(0,l.jsx)(o.Wu,{children:(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-blue-500 rounded-full"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"Log created"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:G(t.date)})]})]}),V.map((e,s)=>(0,l.jsx)("div",{children:(0,l.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,l.jsx)("div",{className:"w-2 h-2 bg-green-500 rounded-full"}),(0,l.jsxs)("div",{className:"flex-1",children:[(0,l.jsx)("p",{className:"text-sm font-medium",children:"Client added"}),(0,l.jsx)("p",{className:"text-xs text-muted-foreground",children:G(e.addedAt)})]})]})},"client-".concat(s)))]})})]})]})]})})}var P=t(40868),F=t(84616),E=t(19420),R=t(12486),Z=t(92657),U=t(32919),B=t(5749);function K(){let{data:e,addClient:s,addProfessionalDomain:t}=(0,p.m)(),{clientLogs:y,createClientDailyLog:L,addClientToLog:K,closeClientDailyLog:O,getLogById:T}=(0,P.U)(),[z,M]=(0,n.useState)(y),[$,W]=(0,n.useState)(""),[H,Y]=(0,n.useState)(1),[_,V]=(0,n.useState)(10),[X,q]=(0,n.useState)(null),[G,J]=(0,n.useState)(!1),[Q,ee]=(0,n.useState)(!1),[es,et]=(0,n.useState)(null),[el,en]=(0,n.useState)({clientId:"",notes:""}),[ea,ei]=(0,n.useState)(""),[ec,er]=(0,n.useState)(1),[eo,ed]=(0,n.useState)(5),[ex,em]=(0,n.useState)(null),[eh,eu]=(0,n.useState)("All Domains"),[ej,eg]=(0,n.useState)([]),[ef,eN]=(0,n.useState)(!1),ep=e=>{let s="asc";X&&X.key===e&&"asc"===X.direction&&(s="desc"),q({key:e,direction:s})},ev=e=>{let s="asc";ex&&ex.key===e&&"asc"===ex.direction&&(s="desc"),em({key:e,direction:s})};(0,n.useEffect)(()=>{M(y)},[y]);let ew=[...z.filter(e=>{var s,t;return((null===(s=e.date)||void 0===s?void 0:s.toLocaleDateString())||"").includes($.toLowerCase())||(null===(t=e.totalClients)||void 0===t?void 0:t.toString().includes($))})].sort((e,s)=>{if(!X)return 0;let t=e[X.key],l=s[X.key];return null==t&&null==l?0:null==t?1:null==l?-1:t<l?"asc"===X.direction?-1:1:t>l?"asc"===X.direction?1:-1:0}),eA=Math.ceil(ew.length/_),eC=(H-1)*_,ey=ew.slice(eC,eC+_),eD=e.clients.map(e=>({value:e.id,label:"".concat(e.gender," ").concat(e.firstName," ").concat(e.lastName),email:e.email,domain:e.professionalDomain})),eS=[...ej.filter(s=>{let t=e.clients.find(e=>e.id===s.clientId);if(!t)return!1;let l=t.firstName.toLowerCase().includes(ea.toLowerCase())||t.lastName.toLowerCase().includes(ea.toLowerCase())||t.email.toLowerCase().includes(ea.toLowerCase()),n="All Domains"===eh||t.professionalDomain===eh;return l&&n})].sort((s,t)=>{let l,n;if(!ex)return 0;let a=e.clients.find(e=>e.id===s.clientId),i=e.clients.find(e=>e.id===t.clientId);if(!a||!i)return 0;switch(ex.key){case"name":l="".concat(a.firstName," ").concat(a.lastName),n="".concat(i.firstName," ").concat(i.lastName);break;case"email":l=a.email,n=i.email;break;case"domain":l=a.professionalDomain,n=i.professionalDomain;break;case"revenue":l=a.revenue,n=i.revenue;break;case"addedAt":l=s.addedAt,n=t.addedAt;break;default:return 0}return l<n?"asc"===ex.direction?-1:1:l>n?"asc"===ex.direction?1:-1:0}),eb=Math.ceil(eS.length/eo),ek=(ec-1)*eo,eL=eS.slice(ek,ek+eo),eI=[...new Set(e.clients.map(e=>e.professionalDomain))],eP=e=>{eg(ej.filter(s=>s.id!==e))},eF=async e=>{let t=await s(e);eg([...ej,{id:Date.now().toString(),clientId:t.id,clientName:"".concat(e.firstName," ").concat(e.lastName),clientEmail:e.email,addedAt:new Date,notes:"New client created",isOriginal:!1}]),B.oR.success("The new client has been created and added to today's log.",{position:"top-right",autoClose:3e3})},eE=async()=>{if(0===ej.length){B.oR.warning("Please add at least one client before submitting.");return}if(ef&&es&&es.isClosed){B.oR.warning("Closed logs cannot be updated.");return}try{let e;let s=new Date,t=0;if(ef&&es){e=es.id;let s=(es.clients||[]).map(e=>e.clientId);for(let l of ej.filter(e=>!s.includes(e.clientId)))try{await K(e,l.clientId,l.notes||""),t++}catch(e){console.error("Failed to add client ".concat(l.clientId," to log:"),e)}}else try{let l=ej[0];e=await L(s,l.clientId),t++;for(let s=1;s<ej.length;s++){let l=ej[s];try{await K(e,l.clientId,l.notes||""),t++}catch(e){console.error("Failed to add client ".concat(l.clientId," to log:"),e)}}}catch(e){console.error("Failed to create daily log:",e),B.oR.error("There was an error creating the daily log. Please try again.");return}eg([]),J(!1),eN(!1),et(null),B.oR.success("".concat(ef?"Daily log updated":"Daily log created"," successfully. ").concat(t," out of ").concat(ej.length," clients ").concat(ef?"updated":"added",".")),J(!1),T&&e&&T(e).then(s=>{if(s){if(ef){let t=[...z],l=t.findIndex(s=>s.id===e);-1!==l&&(t[l]=s,M(t))}else M([s,...z])}}).catch(e=>{console.error("Failed to refresh log data:",e)})}catch(e){console.error("Failed to submit daily log:",e),B.oR.error("There was an error submitting the log. Please try again.")}},eR=async e=>{try{if(et(e),ee(!0),console.log("Fetching detailed log data for ID:",e.id),T)try{let s=await T(e.id);if(console.log("Fetched fresh log data:",s),s){et(s),console.log("Updated log with fresh data");return}}catch(e){console.log("Error fetching fresh log data:",e)}let s=e.clients||[];console.log("Original log clients:",s),console.log("Log total clients:",e.totalClients),0===s.length&&e.totalClients>0&&(console.log("Creating placeholder clients to match totalClients count"),s=Array.from({length:e.totalClients},(s,t)=>({id:"view-placeholder-".concat(e.id,"-").concat(t),clientId:"unknown-client-".concat(t),clientName:"Unknown Client",clientEmail:"",addedAt:new Date,notes:"Details not fully loaded"})));let t={...e,clients:s};et(t),console.log("Log being sent to modal:",t)}catch(s){console.error("Error preparing log details:",s),et(e),ee(!0)}},eZ=e=>e?(0,l.jsx)(v.A,{className:"h-4 w-4 text-green-600"}):(0,l.jsx)(w.A,{className:"h-4 w-4 text-orange-600"}),eU=e=>e?"bg-green-100 text-green-800":"bg-orange-100 text-orange-800",eB=e=>{if(!e)return"N/A";let s=new Date,t=s.getFullYear()-e.getFullYear(),l=s.getMonth()-e.getMonth();return l<0||0===l&&s.getDate()<e.getDate()?t-1:t},eK=s=>{if(s.isClosed){B.oR.warning("Closed logs cannot be updated.");return}et(s),J(!0),eN(!0),eg((s.clients||[]).map(s=>{let t=e.clients.find(e=>e.id===s.clientId);return t?{id:s.id||Date.now().toString()+Math.random(),clientId:t.id,clientName:"".concat(t.firstName," ").concat(t.lastName),clientEmail:t.email,addedAt:s.addedAt||new Date,notes:s.notes||"",isOriginal:!0}:null}).filter(Boolean))};return(0,l.jsxs)("div",{className:"p-6",children:[(0,l.jsxs)("div",{className:"mb-6",children:[(0,l.jsx)("h1",{className:"text-3xl font-bold",children:"Client Daily Logs"}),(0,l.jsx)("p",{className:"text-gray-600",children:"Track daily client registrations and activities"})]}),(0,l.jsxs)(o.Zp,{children:[(0,l.jsxs)(o.aR,{children:[(0,l.jsxs)("div",{className:"flex justify-between items-center",children:[(0,l.jsx)(o.ZB,{children:"Daily Logs"}),(0,l.jsxs)(d.lG,{open:G,onOpenChange:J,children:[(0,l.jsx)(d.zM,{asChild:!0,children:(0,l.jsxs)(a.$,{children:[(0,l.jsx)(F.A,{className:"mr-2 h-4 w-4"}),ef?"Update Log":"Create Today's Log"]})}),(0,l.jsxs)(d.Cf,{className:"max-w-6xl max-h-[90vh] overflow-y-auto",children:[(0,l.jsx)(d.c7,{children:(0,l.jsx)(d.L3,{children:ef?"Update Client Daily Log - ".concat(null==es?void 0:es.date.toLocaleDateString()):"Create Client Daily Log - ".concat(new Date().toLocaleDateString())})}),(0,l.jsxs)("div",{className:"space-y-6",children:[(0,l.jsxs)(o.Zp,{children:[(0,l.jsx)(o.aR,{children:(0,l.jsx)(o.ZB,{children:"Add Client to Log"})}),(0,l.jsx)(o.Wu,{children:(0,l.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:[(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium",children:"Select Existing Client"}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m.J,{children:"Select Client"}),(0,l.jsx)(f.Z,{value:el.clientId,onValueChange:e=>en({...el,clientId:e}),options:eD,placeholder:"Select client",searchPlaceholder:"Search clients..."})]}),(0,l.jsxs)("div",{className:"space-y-2",children:[(0,l.jsx)(m.J,{htmlFor:"notes",children:"Notes"}),(0,l.jsx)(h.T,{id:"notes",placeholder:"Add any notes about this client...",value:el.notes,onChange:e=>en({...el,notes:e.target.value}),rows:3})]}),(0,l.jsx)(a.$,{onClick:()=>{if(el.clientId){let s=e.clients.find(e=>e.id===el.clientId);s&&(eg([...ej,{id:Date.now().toString(),clientId:el.clientId,clientName:"".concat(s.firstName," ").concat(s.lastName),clientEmail:s.email,addedAt:new Date,notes:el.notes,isOriginal:!1}]),en({clientId:"",notes:""}),B.oR.success("Client added successfully. You can continue adding more clients.",{position:"top-right",autoClose:3e3}))}},disabled:!el.clientId,className:"w-full",children:"Add Client to Log"})]})]}),(0,l.jsxs)("div",{className:"space-y-4",children:[(0,l.jsx)("h3",{className:"text-lg font-medium",children:"Create New Client"}),(0,l.jsx)(N.M,{professionalDomains:e.professionalDomains,onSubmit:eF,onAddProfessionalDomain:e=>{t({name:e})},trigger:(0,l.jsx)(a.$,{className:"w-full",children:"Create Client"})})]})]})})]}),(0,l.jsxs)(o.Zp,{children:[(0,l.jsxs)(o.aR,{children:[(0,l.jsxs)(o.ZB,{children:["Added Clients (",ej.length,")"]}),(0,l.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,l.jsxs)("div",{className:"flex items-center space-x-2 flex-1",children:[(0,l.jsx)(D.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)(i.p,{placeholder:"Search clients...",value:ea,onChange:e=>ei(e.target.value),className:"max-w-sm"})]}),(0,l.jsxs)(u.l6,{value:eh,onValueChange:eu,children:[(0,l.jsx)(u.bq,{className:"w-full sm:w-[200px]",children:(0,l.jsx)(u.yv,{placeholder:"Filter by domain"})}),(0,l.jsxs)(u.gC,{children:[(0,l.jsx)(u.eb,{value:"All Domains",children:"All Domains"}),eI.map(e=>(0,l.jsx)(u.eb,{value:e||"unknown",children:e||"Unknown"},e))]})]})]})]}),(0,l.jsx)(o.Wu,{children:ej.length>0?(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)("div",{className:"overflow-x-auto",children:(0,l.jsxs)(r.XI,{children:[(0,l.jsx)(r.A0,{children:(0,l.jsxs)(r.Hj,{children:[(0,l.jsx)(g.a,{sortKey:"name",currentSort:ex,onSort:ev,children:"Name"}),(0,l.jsx)(g.a,{sortKey:"email",currentSort:ex,onSort:ev,children:"Email"}),(0,l.jsx)(r.nd,{children:"Phone"}),(0,l.jsx)(r.nd,{children:"Age"}),(0,l.jsx)(g.a,{sortKey:"domain",currentSort:ex,onSort:ev,children:"Domain"}),(0,l.jsx)(g.a,{sortKey:"revenue",currentSort:ex,onSort:ev,children:"Revenue"}),(0,l.jsx)(g.a,{sortKey:"addedAt",currentSort:ex,onSort:ev,children:"Added At"}),(0,l.jsx)(r.nd,{children:"Notes"}),(0,l.jsx)(r.nd,{children:"Actions"})]})}),(0,l.jsx)(r.BF,{children:eL.map((s,t)=>{let n=e.clients.find(e=>e.id===s.clientId);return n?(0,l.jsxs)(r.Hj,{children:[(0,l.jsx)(r.nA,{className:"font-medium",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)("span",{className:"text-xs bg-muted px-2 py-1 rounded",children:n.gender}),(0,l.jsxs)("span",{children:[n.firstName," ",n.lastName]})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)(S.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{children:n.email})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)(E.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{children:n.phoneNumber})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)(A.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{children:"N/A"===eB(n.birthDate)?"N/A":"".concat(eB(n.birthDate)," years")})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(b.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)(c.E,{variant:"outline",children:n.professionalDomain})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)(k.A,{className:"h-4 w-4 text-green-600"}),(0,l.jsxs)("span",{className:"font-medium text-green-600",children:[n.revenue.toLocaleString()," DZD"]})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-1",children:[(0,l.jsx)(w.A,{className:"h-4 w-4 text-muted-foreground"}),(0,l.jsx)("span",{className:"text-sm",children:s.addedAt.toLocaleTimeString()})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsx)("span",{className:"text-sm",children:s.notes||"No notes"})}),(0,l.jsx)(r.nA,{children:(0,l.jsx)(a.$,{variant:"outline",size:"sm",onClick:()=>eP(s.id),children:"Remove"})})]},s.id||"client-row-".concat(t,"-").concat(n.id)):null})})]})}),(0,l.jsx)(j.d,{currentPage:ec,totalPages:eb,pageSize:eo,totalItems:eS.length,onPageChange:er,onPageSizeChange:e=>{ed(e),er(1)}})]}):(0,l.jsxs)("div",{className:"text-center py-8 text-muted-foreground",children:[(0,l.jsx)(C.A,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground/50"}),(0,l.jsx)("p",{children:"No clients added to this log yet"})]})})]}),(0,l.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,l.jsx)(a.$,{variant:"outline",onClick:()=>{J(!1),eN(!1),et(null),eg([])},children:"Cancel"}),(0,l.jsxs)(a.$,{onClick:eE,disabled:0===ej.length,children:[(0,l.jsx)(R.A,{className:"mr-2 h-4 w-4"}),ef?"Update Daily Log":"Submit Daily Log (".concat(ej.length," clients)")]})]})]})]})]})]}),(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(D.A,{className:"h-4 w-4 text-gray-400"}),(0,l.jsx)(i.p,{placeholder:"Search logs...",value:$,onChange:e=>W(e.target.value),className:"max-w-sm"})]})]}),(0,l.jsxs)(o.Wu,{children:[(0,l.jsxs)(r.XI,{children:[(0,l.jsx)(r.A0,{children:(0,l.jsxs)(r.Hj,{children:[(0,l.jsx)(g.a,{sortKey:"date",currentSort:X,onSort:ep,children:"Date"}),(0,l.jsx)(g.a,{sortKey:"totalClients",currentSort:X,onSort:ep,children:"Total Clients"}),(0,l.jsx)(r.nd,{children:"Status"}),(0,l.jsx)(r.nd,{children:"Created By"}),(0,l.jsx)(r.nd,{children:"Closed At"}),(0,l.jsx)(r.nd,{className:"text-right",children:"Actions"})]})}),(0,l.jsx)(r.BF,{children:ey.map((e,s)=>{var t,n;return(0,l.jsxs)(r.Hj,{children:[(0,l.jsx)(r.nA,{className:"font-medium",children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(A.A,{className:"h-4 w-4 text-gray-400"}),(0,l.jsx)("span",{children:(null===(t=e.date)||void 0===t?void 0:t.toLocaleDateString())||""})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,l.jsx)(C.A,{className:"h-4 w-4 text-blue-600"}),(0,l.jsx)("span",{className:"font-semibold",children:e.totalClients})]})}),(0,l.jsx)(r.nA,{children:(0,l.jsxs)("div",{className:"flex items-center space-x-2",children:[eZ(e.isClosed),(0,l.jsx)(c.E,{className:eU(e.isClosed),children:e.isClosed?"Closed":"Open"})]})}),(0,l.jsx)(r.nA,{children:e.createdBy}),(0,l.jsx)(r.nA,{children:e.closedAt?e.closedAt.toLocaleString():"-"}),(0,l.jsx)(r.nA,{className:"text-right",children:(0,l.jsxs)("div",{className:"flex justify-end space-x-2",children:[(0,l.jsx)(a.$,{variant:"outline",size:"sm",onClick:()=>eR(e),children:(0,l.jsx)(Z.A,{className:"h-4 w-4"})}),!e.isClosed&&(0,l.jsxs)(l.Fragment,{children:[(0,l.jsx)(a.$,{variant:"outline",size:"sm",onClick:()=>eK(e),children:"Update"}),(0,l.jsxs)(x.Lt,{children:[(0,l.jsx)(x.tv,{asChild:!0,children:(0,l.jsx)(a.$,{variant:"outline",size:"sm",children:(0,l.jsx)(U.A,{className:"h-4 w-4"})})}),(0,l.jsxs)(x.EO,{children:[(0,l.jsxs)(x.wd,{children:[(0,l.jsx)(x.r7,{children:"Close Client Daily Log"}),(0,l.jsxs)(x.$v,{children:["Are you sure you want to close this client daily log for ",null===(n=e.date)||void 0===n?void 0:n.toLocaleDateString(),"?",(0,l.jsx)("span",{className:"block mt-2",children:"This action cannot be undone and the log cannot be reopened or modified after closing."})]})]}),(0,l.jsxs)(x.ck,{children:[(0,l.jsx)(x.Zr,{children:"Cancel"}),(0,l.jsx)(x.Rx,{onClick:()=>O(e.id),children:"Close Log"})]})]})]})]})]})})]},e.id||"log-row-".concat(s))})})]}),(0,l.jsx)(j.d,{currentPage:H,totalPages:eA,pageSize:_,totalItems:ew.length,onPageChange:Y,onPageSizeChange:e=>{V(e),Y(1)}})]})]}),(0,l.jsx)(I,{log:es,open:Q,onOpenChange:ee})]})}},85874:(e,s,t)=>{Promise.resolve().then(t.bind(t,4192))}},e=>{var s=s=>e(e.s=s);e.O(0,[4277,8543,4692,4810,203,3958,9114,697,4710,8969,868,8441,1684,7358],()=>s(85874)),_N_E=e.O()}]);